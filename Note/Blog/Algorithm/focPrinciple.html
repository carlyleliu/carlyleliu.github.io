<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="5txRYykRNG5Z1NrO_ZCLF1GZWnbFmCOLdJHGBVFuCIg">
  <meta name="baidu-site-verification" content="code-XfgDErPTZS">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Reddit+Mono:300,300italic,400,400italic,700,700italic%7CNoto+Sans:300,300italic,400,400italic,700,700italic%7COpen+Sans:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/black/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"carlyleliu.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.20.0","exturl":true,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"hide","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="物理学基础概念 左手定则 将左手的食指，中指和拇指伸直，使其在空间内相互垂直。食指方向代表磁场的方向（从 N 级到 S 级），中指代表电流的方向（从正极到负极），那拇指所指的方向就是受力的方向。可用于判断安培力（运动导体所受到的力）和洛伦兹力（运动电荷所受的力）。  右手定则 伸开右手，使拇指与其余四个手指垂直，并且都与手掌在同一平面内；让磁感线垂直于手心进入，并使拇指指向导线运动方向，这时四指所">
<meta property="og:type" content="website">
<meta property="og:title" content="FOC 原理">
<meta property="og:url" content="https://carlyleliu.github.io/note/Blog/Algorithm/focPrinciple.html">
<meta property="og:site_name" content="Matrix">
<meta property="og:description" content="物理学基础概念 左手定则 将左手的食指，中指和拇指伸直，使其在空间内相互垂直。食指方向代表磁场的方向（从 N 级到 S 级），中指代表电流的方向（从正极到负极），那拇指所指的方向就是受力的方向。可用于判断安培力（运动导体所受到的力）和洛伦兹力（运动电荷所受的力）。  右手定则 伸开右手，使拇指与其余四个手指垂直，并且都与手掌在同一平面内；让磁感线垂直于手心进入，并使拇指指向导线运动方向，这时四指所">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/leftHandRule.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/rightHandRule.jpg">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/AmperesRule.jpg">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-step1-2.jpg">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-step3-4.jpg">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-step5-6.jpg">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-table.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc6step.gif">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/foc.jpg">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/clark.jpg">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/clark2-3.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/park.gif">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/qd.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/drv5055.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-driver.jpg">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm100.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-table.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-1.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-7.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-sector.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-sectorx.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-time1.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-time2.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-time1sector.png">
<meta property="article:published_time" content="2020-06-11T06:34:39.000Z">
<meta property="article:modified_time" content="2025-09-27T03:40:43.580Z">
<meta property="article:author" content="CarlyleLiu">
<meta property="article:tag" content="FOC">
<meta property="article:tag" content="Motor">
<meta property="article:tag" content="Robot">
<meta property="article:tag" content="Actuator">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/leftHandRule.png">


<link rel="canonical" href="https://carlyleliu.github.io/note/Blog/Algorithm/focPrinciple">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":false,"lang":"zh-CN","comments":true,"permalink":"https://carlyleliu.github.io/note/Blog/Algorithm/focPrinciple.html","path":"note/Blog/Algorithm/focPrinciple.html","title":"FOC 原理"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>FOC 原理 | Matrix
</title>
  







<link rel="dns-prefetch" href="https://waline.carlyleliu.vip">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end -->
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Matrix" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Matrix</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">CarlyleLiu‘s Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-alist"><span class="exturl" data-url="aHR0cHM6Ly9hbGlzdC5jYXJseWxlbGl1LnZpcC8="><i class="fa-solid fa-cloud fa-fw"></i>网盘</span></li><li class="menu-item menu-item-books"><span class="exturl" data-url="aHR0cHM6Ly9jYWxpYnJlLmNhcmx5bGVsaXUudmlwLw=="><i class="fa-solid fa-book fa-fw"></i>书库</span></li><li class="menu-item menu-item-talk"><span class="exturl" data-url="aHR0cHM6Ly9tZW1vcy5jYXJseWxlbGl1LnZpcC9leHBsb3JlLw=="><i class="fas fa-comments fa-fw"></i>随笔</span></li><li class="menu-item menu-item-album"><span class="exturl" data-url="aHR0cHM6Ly9pbW1pY2guY2FybHlsZWxpdS52aXAvc2hhcmUvSmtSenVqZERfdWVJRnJRNHpvYnpfUW1EVndRZkdGS3ZyVTh0ZlJIYWN1ZG9ZMjV0Z2tFdDd6aS1Wck5oYUEzZUdpNC8="><i class="fa-solid fa-image fa-fw"></i>相册</span></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%89%A9%E7%90%86%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="nav-text">物理学基础概念</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A6%E6%89%8B%E5%AE%9A%E5%88%99"><span class="nav-text">左手定则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%B3%E6%89%8B%E5%AE%9A%E5%88%99"><span class="nav-text">右手定则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E5%9F%B9%E5%AE%9A%E5%88%99%E5%8F%B3%E6%89%8B%E8%9E%BA%E6%97%8B%E5%AE%9A%E5%88%99"><span class="nav-text">安培定则（右手螺旋定则）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E5%9F%B9%E5%8A%9B%E5%AE%9A%E5%88%99"><span class="nav-text">安培力定则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AF%95%E5%A5%A5%E8%90%A8%E4%BC%90%E5%B0%94%E5%AE%9A%E5%BE%8B"><span class="nav-text">毕奥─萨伐尔定律</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B4%9B%E4%BC%A6%E5%85%B9%E5%8A%9B"><span class="nav-text">洛伦兹力</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9B%B4%E6%B5%81%E7%94%B5%E6%9C%BA%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B"><span class="nav-text">直流电机基本方程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%B5%E6%9E%A2%E7%BB%95%E7%BB%84%E7%9A%84%E6%84%9F%E5%BA%94%E7%94%B5%E5%8A%A8%E5%8A%BF"><span class="nav-text">电枢绕组的感应电动势</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%B5%E6%9E%A2%E7%9A%84%E7%94%B5%E7%A3%81%E8%BD%AC%E9%92%9C"><span class="nav-text">电枢的电磁转钜</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E6%AD%A5%E9%A9%B1%E5%8A%A8"><span class="nav-text">六步驱动</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#foc-%E7%AE%97%E6%B3%95"><span class="nav-text">FOC 算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B4%E4%BD%93%E6%8E%A7%E5%88%B6%E6%A1%86%E5%9B%BE"><span class="nav-text">整体控制框图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#park-%E5%8F%98%E6%8D%A2"><span class="nav-text">park 变换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#park-%E5%8F%8D%E5%8F%98%E6%8D%A2"><span class="nav-text">Park 反变换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#svpwm"><span class="nav-text">SVPWM</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-text">基本原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC"><span class="nav-text">推导</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E6%AE%B5%E5%BC%8F-svpwm"><span class="nav-text">七段式 SVPWM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%88%E6%88%90%E7%9F%A2%E9%87%8Fu_ref%E6%89%80%E5%A4%84%E6%89%87%E5%8C%BA-n-%E7%9A%84%E5%88%A4%E6%96%AD"><span class="nav-text">合成矢量Uref所处扇区
N 的判断</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%9F%A2%E9%87%8F%E4%BD%9C%E7%94%A8%E6%97%B6%E9%97%B4%E8%AE%A1%E7%AE%97"><span class="nav-text">基本矢量作用时间计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#svpwm-%E7%89%A9%E7%90%86%E5%90%AB%E4%B9%89"><span class="nav-text">SVPWM 物理含义</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%80%E7%8E%AF%E6%8E%A7%E5%88%B6"><span class="nav-text">开环控制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E7%AE%97%E6%B3%95"><span class="nav-text">其他算法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="nav-text">参考文献</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CarlyleLiu</p>
  <div class="site-description" itemprop="description">CarlyleLiu’s Blog</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">207</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nhcmx5bGVsaXU=" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;carlyleliu"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnl5bGl1c2h1YWlAZ21haWwuY29t" title="E-Mail → mailto:yyliushuai@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95eWxpdXNodWFp" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;yyliushuai"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly95b3V0dWJlLmNvbS9jYXJseWxlbGl1" title="YouTube → https:&#x2F;&#x2F;youtube.com&#x2F;carlyleliu"><i class="fab fa-youtube fa-fw"></i>YouTube</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9pbnN0YWdyYW0uY29tL2JsdXJyZWRsaXU=" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;blurredliu"><i class="fab fa-instagram fa-fw"></i>Instagram</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC96aC1DTg=="><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
    </div>

    
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner page posts-expand">


    
    
    
    <div class="post-block" lang="zh-CN"><header class="post-header">

<h1 class="post-title" itemprop="name headline">FOC 原理
</h1>

<div class="post-meta-container">
  <ul class="breadcrumb">
            <li><a href="/note/">NOTE</a></li>
            <li><a href="/note/Blog/">BLOG</a></li>
            <li><a href="/note/Blog/Algorithm/">ALGORITHM</a></li>
            <li>FOCPRINCIPLE</li>
  </ul>
</div>

</header>

      
      
      
      <div class="post-body">
          <h1 id="物理学基础概念">物理学基础概念</h1>
<h2 id="左手定则">左手定则</h2>
<p>将左手的食指，中指和拇指伸直，使其在空间内相互垂直。食指方向代表磁场的方向（从
N 级到 S
级），中指代表电流的方向（从正极到负极），那拇指所指的方向就是受力的方向。可用于判断安培力（运动导体所受到的力）和洛伦兹力（运动电荷所受的力）。
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/leftHandRule.png"></p>
<h2 id="右手定则">右手定则</h2>
<p>伸开右手，使拇指与其余四个手指垂直，并且都与手掌在同一平面内；让磁感线垂直于手心进入，并使拇指指向导线运动方向，这时四指所指的方向就是感应电流的方向。用于判断导体在做切割磁场时产生的电流方向。
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/rightHandRule.jpg"></p>
<span id="more"></span>
<h2 id="安培定则右手螺旋定则">安培定则（右手螺旋定则）</h2>
<p>电直导线中的安培定则（安培定则一）：用右手握住通电直导线，让大拇指指向直导线中电流方向，那么四指指向就是通电导线周围磁场的方向；
通电螺线管中的安培定则（安培定则二）：用右手握住通电螺线管，让四指指向电流的方向，那么大拇指所指的那一端是通电螺线管的
N 极。 <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/AmperesRule.jpg"></p>
<h2 id="安培力定则">安培力定则</h2>
<p><strong>安培力：</strong> 以电流强度为 I 的长度为 L
的直导线，置于磁感应强度为 B
的均匀外磁场中，则导线受到的安培力的大小为：</p>
<p><span class="math display"><em>F</em> = <em>I</em><em>B</em><em>L</em><em>s</em><em>i</em><em>n</em><em>α</em></span></p>
<p>式中α为导线中的电流方向与 B 方向之间的夹角。
设定两条细直、无限长、固定的、相互平行的载流导线，则在自由空间内，任意一条导线施加于对方的每单位长度作用力<span class="math inline"><em>f</em><sub><em>m</em></sub></span>是：</p>
<p><span class="math display">$$
f_m = \frac{\mu_0 I_1 I_2 }{2\pi r}
$$</span></p>
<p>其中，<span class="math inline"><em>μ</em><sub>0</sub></span>
是真空磁导率，<span class="math inline"><em>I</em><sub>1</sub>, <em>I</em><sub>2</sub></span>
分别是流动于两条导线的电流，r
是两条导线之间的垂直距离。采用国际单位制，<span class="math inline"><em>μ</em><sub>0</sub></span>值定义为：</p>
<p><span class="math display"><em>μ</em><sub>0</sub> = 4<em>π</em> × 10<sup>−7</sup></span></p>
<h2 id="毕奥萨伐尔定律">毕奥─萨伐尔定律</h2>
<p>长直载流导线周围的磁感应强度大小与距离成反比、与电流成正比。</p>
<p><span class="math display">$$
dB = \frac{\mu _0}{4\pi} \frac{Idl sin\theta }{r^2}
$$</span></p>
<p>真空磁导率：</p>
<p><span class="math display"><em>μ</em><sub>0</sub> = 4<em>π</em> × 10<sup>−7</sup><em>N</em> ⋅ <em>A</em><sup>−2</sup></span></p>
<p>载流直导线、圆形载流导线、载流密绕直螺线管的磁场都是通过该公式求取。具体细节可参考
<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNDIzNzYzODM=">毕奥─萨伐尔定律<i class="fa fa-external-link-alt"></i></span>
在通电螺线管中产生的磁场强度是正比与导线中的电流和导线匝数的。</p>
<h2 id="洛伦兹力">洛伦兹力</h2>
<p>在电动力学里，若考虑一带电粒子在电磁场中的受力，可以用以下的劳仑兹力定律表示：</p>
<p><span class="math display"><em>F</em> = <em>q</em>(<em>E</em> + <em>v</em> × <em>B</em>)</span></p>
<p>这里 F 是洛伦兹力，q 是是带电粒子的电荷量，E 是电场，v
是带电粒子的速度，B 是磁场。这方程式右边有两项，第一项是电场力<span class="math inline"><em>F</em><sub><em>E</em></sub> = <em>q</em><em>E</em></span>
，第二项是磁场力<span class="math inline"><em>F</em><sub><em>B</em></sub> = <em>q</em><em>v</em> × <em>B</em></span>。</p>
<h1 id="直流电机基本方程">直流电机基本方程</h1>
<h2 id="电枢绕组的感应电动势">电枢绕组的感应电动势</h2>
<p>若电枢导体的有效长度为 l，导体切割气隙磁场的线速度为
v，则每根导体中的感应电动势<span class="math inline"><em>e</em><sub><em>c</em></sub></span>为：</p>
<p><span class="math display"><em>e</em><sub><em>c</em></sub> = <em>b</em><sub><em>σ</em></sub><em>l</em><em>v</em></span></p>
<p>式中<span class="math inline"><em>b</em><sub><em>σ</em></sub></span>为导体所在位置处的气隙磁通密度。，若电枢绕组的总导体数为<span class="math inline"><em>Z</em><sub><em>a</em></sub></span>每条支路串联导体数等于<span class="math inline">$\frac{Z_a}{2a}$</span>则支路电动势<span class="math inline"><em>E</em><sub><em>a</em></sub></span>为：</p>
<p><span class="math display">$$
E_a = \sum_{1}^{\frac{Z_a}{2a}}b_{\delta }lv =
lv\sum_{1}^{\frac{Z_a}{2a}}b_{\delta }(x_i)
$$</span></p>
<p>式中各点气隙磁通密度<span class="math inline"><em>b</em><sub><em>δ</em></sub>(<em>x</em><sub><em>i</em></sub>)</span>互不相同，所以每根导体的电动势也不相同，为简单记，引入平均气隙磁通密度<span class="math inline"><em>B</em><sub><em>a</em><em>v</em></sub></span>，记：</p>
<p><span class="math display">$$
B_{av} \approx \frac{1}{\frac{Z_a}{2a}}
\sum_{1}^{\frac{Z_a}{2a}}b_{\delta }(x_i)
$$</span></p>
<p>则<span class="math inline"><em>E</em><sub><em>a</em></sub></span>可以写为：</p>
<p><span class="math display">$$
E_a = lv\frac{Z_a}{2a}B_{av}
$$</span></p>
<p>考虑到线速度<span class="math inline">$v = 2p \tau
\frac{n}{60}$</span>, 其中<span class="math inline"><em>τ</em></span>为极距，$2$为电枢周长将 v
代入可以得到：</p>
<p><span class="math display">$$
E_a = 2\frac{pn}{60}\frac{Z_a}{2a}(B_{av}\tau l) = \frac{pZ_a}{60a}n\Phi
= C_e n \Phi
$$</span></p>
<p>式中<span class="math inline"><em>Φ</em></span>表示每极的总磁通量，他等于一个极下的平均气隙磁通密度<span class="math inline"><em>B</em><sub><em>a</em></sub><em>v</em></span>乘以一个极的面积<span class="math inline"><em>l</em><em>τ</em></span>即$= B_{av}l$, <span class="math inline"><em>C</em><sub><em>e</em></sub></span>称为电动势常数，<span class="math inline">$C_e = \frac{p Z_a}{60a}$</span> .
这就是电枢绕组的电动势方程。对发电机和电动机都适用。</p>
<h2 id="电枢的电磁转钜">电枢的电磁转钜</h2>
<p>设导体中电流为<span class="math inline"><em>i</em><sub><em>a</em></sub></span>导体所在位置的气隙磁通密度为<span class="math inline"><em>b</em><sub><em>δ</em></sub></span>,
则作用在该导体上的电磁转钜<span class="math inline"><em>T</em><sub><em>c</em></sub></span>为：</p>
<p><span class="math display">$$
T_c = b_{\delta} l i_a \frac{D_a}{2}
$$</span></p>
<p><span class="math inline"><em>D</em><sub><em>a</em></sub></span>为电枢外径，由于一个极下载流导体数为<span class="math inline">$\frac{Z_a}{2p}$</span>，所以作用在一个极下载流导体上的合成电磁转钜<span class="math inline"><em>T</em><sub><em>p</em></sub></span>应为：</p>
<p><span class="math display">$$
T_p = li_a \frac{D_a}{2}\sum_{1}^{\frac{Z_a}{2p}}b_{\delta }(x_i) =
(\frac{Z_a}{2p}B_{av})li_a\frac{D_a}{2}
$$</span></p>
<p>式中<span class="math inline"><em>B</em><sub><em>a</em><em>v</em></sub></span>为气隙磁通密度平均值，作用在整个电枢上的电磁转钜<span class="math inline"><em>T</em><sub><em>e</em></sub></span>应为<span class="math inline"><em>T</em><sub><em>p</em></sub></span>乘以 2p
即：</p>
<p><span class="math display">$$
T_e = 2pT_p = Z_aB_{av}li_a \frac{D_a}{2}
$$</span></p>
<p>考虑到<span class="math inline"><em>π</em><em>D</em><sub><em>a</em></sub> = 2<em>p</em><em>τ</em>, <em>Φ</em> = <em>B</em><sub><em>a</em><em>v</em></sub><em>l</em><em>τ</em></span>支路电流<span class="math inline">$i_a = \frac{I_a}{2a}$</span>, 其中<span class="math inline"><em>I</em><sub><em>a</em></sub></span>为电枢电流，可得：</p>
<p><span class="math display">$$
T_e = Z_aB_{av}l(\frac{I_a}{2a}) \frac{p \tau}{\pi} = \frac{p}{2\pi}
\frac{Z_a}{a} \Phi  I_a = C_T \Phi  I_a
$$</span></p>
<p>式中<span class="math inline"><em>C</em><sub><em>T</em></sub></span>为转钜常数，这就是直流电机的转钜公式。对发电机和电动机都适用。</p>
<h1 id="六步驱动">六步驱动</h1>
<p><img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-step1-2.jpg">
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-step3-4.jpg">
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-step5-6.jpg">
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-table.png"></p>
<p>采用动图表示如下： <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc6step.gif"></p>
<p>BLDC 的六步方波控制参考 <span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjQwMDA3NC9hcnRpY2xlL2RldGFpbHMvMTEyMTczNTE3">BLDC
的六步方波控制<i class="fa fa-external-link-alt"></i></span></p>
<p>BLDC
就是通过三相进行改变线圈的电流方向来改变磁场方向，从而免去使用换向器来提高电机的性能，以上是
bldc 的六步控制法，
但是这个控制太粗略了，不能实现对电机的力矩，速度以及位置的闭环控制，为此前人开发了一些控制算法，本文只介绍
foc 这一种控制算法。</p>
<h1 id="foc-算法">FOC 算法</h1>
<h2 id="整体控制框图">整体控制框图</h2>
<p><img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/foc.jpg"></p>
<p>这里先将 FOC 控制框图列出，在下面将会一个模块一个模块当介绍。 ##
clark 变换 <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/clark.jpg"></p>
<p>在上图中 clark 变换是将<span class="math inline"><em>I</em><sub><em>a</em></sub><em>I</em><sub><em>b</em></sub><em>I</em><sub><em>c</em></sub></span>三相电流变为<span class="math inline"><em>I</em><sub><em>α</em></sub><em>I</em><sub><em>β</em></sub></span>两项电流，在实际的使用中需要对三相电流进行采集以获得实际电机中的电流，但是三相电流呈
120
度相位差分布并不够直观而且有信息冗余，根据基尔霍夫定律，三相电流矢量和应该为
0，因此可以使用两项进行表示，我们对直角坐标系很熟悉，因此这里将三相电流转化为直角系的两项坐标系的过程就是
clark 变换，详细变换如下：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;I_{\alpha } = I_a - cos(\frac{\pi }{3})I_b - cos(\frac{2\pi
}{3})I_c \\
&amp;I_{\beta } = sin(\frac{\pi }{3})I_b - sin(\frac{\pi }{3})I_c
\end{aligned}
$$</span></p>
<p>写成矩阵形式如下：</p>
<p><span class="math display">$$
\begin{bmatrix} I_{\alpha }\\  I_{\beta } \end{bmatrix} =
\begin{bmatrix} 1 &amp; -\frac{1}{2} &amp; -\frac{1}{2}\\ 0 &amp;
\frac{\sqrt{3}}{2} &amp; -\frac{\sqrt{3}}{2} \end{bmatrix}
\begin{bmatrix} I_a\\
I_b\\ I_c\end{bmatrix}
$$</span></p>
<p>但是到这里还没完，我们在实际使用过程中使用的公司并不是这个而是有一个系数
k 来调整为等幅变换或等功率变换，实际使用的公式如下：</p>
<p><span class="math display">$$
\begin{bmatrix} I_{\alpha }\\  I_{\beta } \end{bmatrix} = k *
\begin{bmatrix} 1 &amp; -\frac{1}{2} &amp; -\frac{1}{2}\\ 0 &amp;
\frac{\sqrt{3}}{2} &amp; -\frac{\sqrt{3}}{2} \end{bmatrix}
\begin{bmatrix} I_a\\
I_b\\ I_c\end{bmatrix}
$$</span></p>
<p>在等幅值变换中<span class="math inline">$k =
\frac{2}{3}$</span>具体推导如下：</p>
<p><img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/clark2-3.png"></p>
<p>以相电压来作为推导而不是相电流，设<span class="math inline"><em>V</em><sub><em>m</em></sub></span>是相电压峰值，则：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;U_a = V_m * cos(\theta) \\
&amp;U_b = V_m * cos(\theta - \frac{2\pi }{3}) \\
&amp;U_c = V_m * cos(\theta + \frac{2\pi }{3}) \\
&amp;U_a + U_b + U_c = 0
\end{aligned}
$$</span></p>
<p>这里<span class="math inline"><em>θ</em> = 2<em>π</em><em>f</em><em>t</em></span>将这三相电压合成空间电压矢量<span class="math inline"><em>U</em><sub><em>t</em></sub></span>为：</p>
<p><span class="math display">$$
U_t = U_a + U_b * e^{\frac{2 \pi j}{3}} + U_c * e^{\frac{4 \pi j}{3}} =
\frac{3}{2}V_m * e^{j\theta }
$$</span></p>
<p>由此可以看出合成的电压矢量是原来的<span class="math inline">$\frac{3}{2}$</span>, 但是为什么会多出来？？？
因此当<span class="math inline">$k =
\frac{2}{3}$</span>时合成矢量将与变换前一致，就是等幅值转换，将<span class="math inline">$k =
\frac{2}{3}$</span>代入先前公式并化简可以得到：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;U_{\alpha } = U_a \\
&amp;U_{\beta } = \frac{1}{\sqrt{3}}(U_a + 2U_b)
\end{aligned}
$$</span></p>
<p>另一种变换是等功率变换，当<span class="math inline">$k =
\sqrt{\frac{2}{3}}$</span>为等功率变换，详细推导过程可以参考 <span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RhaWRpMTk4OS9hcnRpY2xlL2RldGFpbHMvODk5MjYzMjQ=">Clark
变换及比例系数 2/3 推导过程<i class="fa fa-external-link-alt"></i></span></p>
<p>关于电流采样参考 [[FOCCurrentSampling]]</p>
<h2 id="park-变换">park 变换</h2>
<p><img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/park.gif"></p>
<p>dq 坐标系是建立在转子上的直角坐标系，其中：</p>
<p>d 轴方向与转子磁链方向重合，又叫直轴； q
轴方向与转子磁链方向垂直，又叫交轴；</p>
<p>d 轴和𝑞轴 q 轴如下图所示； <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/qd.png"></p>
<p>相对与定子来说是旋转的坐标系，在 dq 坐标系下<span class="math inline"><em>i</em><sub><em>d</em></sub><em>i</em><sub><em>q</em></sub></span>为恒定值而不再是正弦值。park
变换的本质是静止坐标系αβ乘以一个旋转矩阵，从而得到 dq 坐标系：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;i_d = i_{\alpha} * cos(\theta) + i_{\beta} * sin(\theta) \\
&amp;i_q = -i_{\alpha} * sin(\theta) + i_{\beta} * cos(\theta)
\end{aligned}
$$</span></p>
<p>写成矩阵式为：</p>
<p><span class="math display">$$
\begin{bmatrix}i_d\\ i_q\end{bmatrix} = \begin{bmatrix}cos(\theta )
&amp; sin(\theta )\\ -sin(\theta ) &amp; cos(\theta
)\end{bmatrix}\begin{bmatrix}i_{\alpha }\\ i_{\beta }\end{bmatrix}
$$</span></p>
<p>通过 park
变换后将交流信号转变为直流信号，这样就方便进行信号调节，像使用 pid
控制器对电机信号进行控制。</p>
<h2 id="park-反变换">Park 反变换</h2>
<p>Park 反变换又叫直交变换，由 dq
轴的直流量，最终变换到αβ的交流量，其公式如下：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;i_{\alpha} = i_d * cos(\theta) - i_q * sin(\theta) \\
&amp;i_{\alpha} = i_d * sin(\theta) + i_q * cos(\theta)
\end{aligned}
$$</span></p>
<p>写成矩阵形式如下：</p>
<p><span class="math display">$$
\begin{bmatrix}i_{\alpha }\\ i_{\beta }\end{bmatrix} =
\begin{bmatrix}cos(\theta ) &amp; -sin(\theta )\\ sin(\theta ) &amp;
cos(\theta )\end{bmatrix}\begin{bmatrix}i_d\\ i_q\end{bmatrix}
$$</span></p>
<p>因为 svpwm 使用的坐标系还是αβ坐标系，在经过 park
变换后进行调控例如使用 pid 控制器对其中的参数进行调控后需要再经过反 park
变换回去输入到 svpwn 模块中去。</p>
<p>这里需要注意 park 变换是需要电角度信息的，因此这里涉及无感和有感两种
foc，由于本人也没有研究过无感 foc 因此这里只讲下有感
foc。所谓有感就是有传感器，通过传感器获得电机转子的位置，传感器种类很多有光电式和霍尔传感器式，按照获取角度类型可以分为绝对式编码器和相对式编码器，但无论哪种传感器最终都是获得电机转子的位置，然后在
park 变换的时候用于将<span class="math inline"><em>α</em><em>β</em></span>坐标系转换到 dq
坐标系下。这里以常见的霍尔传感器为例来说明一下，霍尔传感器又分为线性霍尔传感器和开关型霍尔传感器，线性霍尔传感器可以获得更精细的角度信息，例如
ti 的 DRV5055, 这种传感器如果想要获得较好的性能一般使用两个传感器呈 90
度角度排列，这种传感器使用前需要进行校准，对磁场的最大值和最小值进行校准更精确的校准是对其进行尺度因子的校准这个一般不需要；另一种是开关型霍尔传感器一般使用
3 个传感器彼此之间呈 60 度或 120
度排布。除此之外还有一种集成式传感器，通过 iic 或 spi
接口数字输出角度信息，例如 as5600，tle5012b
等，这种使用起来更加简单，不需要对传感器进行校准只需要对电角度和机械角度进行校准即可。
下面以 drv5055 这种线性霍尔传感器为例说明一下使用注意事项： drv5055
线性霍尔传感器输出的是模拟信号，可以检测磁场强弱信号，在电机的转子上需要安装一个径向冲磁的圆形或圆环型磁铁，然后两个
drv5055 呈 90 度分布在磁铁的外环位置，当电机转转一周传感器将经历完整的从
N 极到 S 极的磁场信号，输出为一个周期的正弦曲线，两个传感器输出如下：
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/drv5055.png"></p>
<p>两个呈 90 摆放的 drv5055
传感器在电机转子旋转一周输出的波形如上图所示，这里主要说明两点：</p>
<ul>
<li>使用呈 90 度摆放的两个传感器的好处：单个传感器以上图<span class="math inline"><em>B</em><sub><em>x</em></sub></span>为例在最大值和最小值的地方斜率为
0 附近斜率也非常小，在值为 0
附近斜率最大，因此当转子在极值处值变化不明显会容易出现误差，而两个呈 90
度摆放的传感器就刚好弥补了这个缺点。</li>
<li>关于传感器校准，从上图可以看到两个传感器的幅值不同，一般情况下都是不同的，两个传感器不可能做的完全一样而且安装也会又偏差，因此需要对传感器进行校准，校准方法就是对两个传感器进行归一化处理，分别找到两个传感器对极值进而就确定了中值（理想情况下中值为
0 但实际上往往存在偏差）将其归一化到 [-1, 1]
这个值域内就完成了对传感器对校准。</li>
</ul>
<h2 id="svpwm">SVPWM</h2>
<h3 id="概述">概述</h3>
<p><img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/bldc-driver.jpg"></p>
<p>SVPWM
是近年发展的一种比较新颖的控制方法，是由三相功率逆变器的六个功率开关元件组成的特定开关模式产生的脉宽调制波，能够使输出电流波形尽
可能接近于理想的正弦波形。空间电压矢量 PWM 与传统的正弦 PWM
不同，它是从三相输出电压的整体效果出发，着眼于如何使电机获得理想圆形磁链轨迹。
SVPWM 技术与 SPWM 相比较，绕组电流波形的谐波
成分小，使得电机转矩脉动降低，旋转磁场更逼近圆形，而且使直流母线电压的利用率有了很大提高，且更易于实现数字化。下面将对该算法进行详细分析阐述。</p>
<h3 id="基本原理">基本原理</h3>
<p>SVPWM
的理论基础是平均值等效原理，即在一个开关周期内通过对基本电压矢量加以组合，使其平均值与给定电压矢量相等。在某个时刻，电压矢量旋转到某个区域中，可由组成这个区域的两个相邻的非零矢量和零矢量在时间上的不同组合来得到。两个矢量的作用时间在一个采样周期内分多次施加，从而控制各个电压矢量的作用时间，使电压空间矢量接近按圆轨迹旋转，通过逆变器的不同开关状态所产生的实际磁通去逼近理想磁通圆，并由两者的比较结果来决定逆变器的开关状态，从而形成
PWM 波形。 由于逆变器三相桥臂共有 6
个开关管，为了研究各相上下桥臂不同开关组合时逆变器输出的
空间电压矢量，特定义开关函数 Sx ( x = a、b、c) 为：</p>
<p><span class="math display">$$
S_x = \left\{\begin{matrix}
1（上桥臂导通）\\
0（下桥臂导通）
\end{matrix}\right.
$$</span></p>
<p>(Sa、Sb、Sc) 的全部可能组合共有八个，包括 6 个非零矢量
Ul(001)、U2(010)、U3(011)、U4(100)、U5(101)、U6(110)、和两个零矢量
U0(000)、U7(111)，下面以其中一 种开关组合为例分析，假设 Sx ( x=
a、b、c)= (100)， 此时： <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm100.png"></p>
<p><span class="math display">$$
\begin{aligned}
&amp;U_{ab} = U_{dc}, U_{bc} = 0, U_{ca} = -U_{dc} \\
&amp;U_{aN} - U_{bN} = U_{dc},U_{aN} - U_{cN} = U_{dc} \\
&amp;U_{aN} + U_{bN} + U_{cN} = 0
\end{aligned}
$$</span></p>
<p>求解上述方程可得：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;U_{aN} = \frac{2U_d}{3} \\
&amp;U_{bN} = - \frac{U_d}{3} \\
&amp;U_{cN} = - \frac{U_d}{3}
\end{aligned}
$$</span></p>
<p>同理可计算出其它各种组合下的空间电压矢量，列表如下：</p>
<p><img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-table.png">
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm.png"></p>
<p>其中非零矢量的幅值相同（模长为 <span class="math inline">$\frac{2U_{dc}}{3}$</span>），相邻的矢量间隔
60°，而两个零矢量幅值为零，位于中心。在每一个扇区，选择相邻的两个电压矢量以及零矢量，按照伏秒平衡的原则来合成每个扇区内的任意电压矢量，即：</p>
<p><span class="math display">∫<sub>0</sub><sup><em>T</em></sup><em>U</em><sub><em>r</em><em>e</em><em>f</em></sub><em>d</em><em>t</em> = ∫<sub>0</sub><sup><em>T</em><sub><em>x</em></sub></sup><em>U</em><sub><em>x</em></sub><em>d</em><em>t</em> + ∫<sub><em>T</em><sub><em>x</em></sub></sub><sup><em>T</em><sub><em>x</em></sub> + <em>T</em><sub><em>y</em></sub></sup><em>U</em><sub><em>y</em></sub><em>d</em><em>t</em> + ∫<sub><em>T</em><sub><em>x</em></sub> + <em>T</em><sub><em>y</em></sub></sub><sup><em>T</em></sup><em>U</em><sub>0</sub><em>d</em><em>t</em></span></p>
<p>等效与下式：</p>
<p><span class="math display"><em>U</em><sub><em>r</em><em>e</em><em>f</em></sub> * <em>T</em> = <em>U</em><sub><em>x</em></sub> * <em>T</em><sub><em>x</em></sub> + <em>U</em><sub><em>y</em></sub> * <em>T</em><sub><em>y</em></sub> + <em>U</em><sub>0</sub> * <em>T</em><sub>0</sub></span></p>
<p>其中，<span class="math inline"><em>U</em><sub><em>r</em><em>e</em><em>f</em></sub></span>
为期望电压矢量；T 为采样周期；<span class="math inline"><em>T</em><sub><em>x</em></sub>、<em>T</em><sub><em>y</em></sub>、<em>T</em><sub>0</sub></span>
分别为对应两个非零电压矢量 <span class="math inline"><em>U</em><sub><em>x</em></sub>、<em>U</em><sub><em>y</em></sub></span>和零电压矢量<span class="math inline"><em>U</em><sub>0</sub></span>在一个采样周期的作用时间；其中<span class="math inline"><em>U</em><sub>0</sub></span>包括了<span class="math inline"><em>U</em><sub>0</sub></span>和<span class="math inline"><em>U</em><sub>7</sub></span>两个零矢量。上式的意义是，矢量
<span class="math inline"><em>U</em><sub><em>r</em><em>e</em><em>f</em></sub></span>
在 T 时间内所产生的积分效果值和 <span class="math inline"><em>U</em><sub><em>x</em></sub>、<em>U</em><sub><em>y</em></sub>、<em>U</em><sub>0</sub></span>分别在时间<span class="math inline"><em>T</em><sub><em>x</em></sub>、<em>T</em><sub><em>y</em></sub>、<em>T</em><sub>0</sub></span>内产生的积分效果相加总和值相同。由于三相正弦波电压在电压空间向量中合成一个等效的旋转电压，其旋转速度是输入电源角频率，等效旋转电压的轨迹将是如上图所示的圆形。所以要产生三相正弦波电压，可以利用以上电压向量合成的技术，在电压空间向量上，将设定的电压向量由
U4(100)
位置开始，每一次增加一个小增量，每一个小增量设定电压向量可以用该区中相邻的两个基本非零向量与零电压向量予以合成，如此所得到的设定电压向量就等效于一个在电压空间向量平面上平滑旋转的电压空间向量，从而达到电压空间向量脉宽调制的目的。</p>
<h3 id="推导">推导</h3>
<p>三相电压给定所合成的电压向量旋转角速度为ω=2πf，旋转一周所需的时间为 T
=1/f ；若载波频率是 fs，则频率比为 R = fs /
f。这样将电压旋转平面等切割成 R 个小增量，亦
即设定电压向量每次增量的角度是 ：</p>
<p><span class="math display">$$
\gamma = \frac{2}{R} = \frac{2 \pi f}{fs} = \frac{2Ts}{T}
$$</span></p>
<p>假设欲合成的电压向量 <span class="math inline"><em>U</em><sub><em>r</em><em>e</em><em>f</em></sub></span>
在第Ⅰ区中第一个增量的位置，如下图所示，欲用 U4、U6、U0 及 U7
合成，用平均值等效可得：<span class="math inline"><em>U</em><sub><em>r</em></sub><em>e</em><em>f</em> * <em>T</em><em>z</em> = <em>U</em>4 * <em>T</em>4 + <em>U</em>6 * <em>T</em>6</span>
。 <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-1.png"></p>
<p>在两相静止参考坐标系（α，β）中，令<span class="math inline"><em>U</em><sub><em>r</em><em>e</em><em>f</em></sub></span>和
U4 间的夹角是θ，由正弦定理可得：</p>
<p><span class="math display">$$
\left | U_{ref} \right | cos(\theta ) = \frac{T_4}{T_s}\left | U_4
\right | + \frac{T_6}{T_s} \left | U_6 \right | cos(\frac{\pi }{3})\\
\left | U_{ref} \right | sin(\theta ) =  \frac{T_6}{T_s} \left | U_6
\right | sin(\frac{\pi }{3})
$$</span></p>
<p>因为 |U4 |=|U6|=2Udc/3 ，所以可以得到各矢量的状态保持时间为：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;T_4 = mT_s sin(\frac{\pi }{3} - \theta ) \\
&amp;T_6 = mT_s sin(\theta )
\end{aligned}
$$</span></p>
<p>式中 m 为 SVPWM 调制系数（调制比）， <span class="math inline">$m=
\frac{\sqrt{3}\left | U_{ref} \right
|}{U_{dc}}$</span>。而零电压向量所分配的时间为：T7=T0=(TS-T4-T6 ) /2
或者 T7 =(TS-T4-T6 ) 得到以 U4、U6、U7 及 U0 合成的 Uref
的时间后，接下来就是如何产生实际的脉宽调制波形。在 SVPWM
调制方案中，零矢量的选择是最具灵活性的，适当选择零矢量，可最大限度地减少开关次数，尽可能避免在负载电流较大的时刻的开关动作，最大限度地减少开关损耗。</p>
<h3 id="七段式-svpwm">七段式 SVPWM</h3>
<p>我们以减少开关次数为目标，将基本矢量作用顺序的分配原则选定为：在每次开关状态转换时，只改变其中一相的
开关状态。并且对零矢量在时间上进行了平均分配，以使产生的 PWM
对称，从而有效地降低 PWM 的谐波分量。当 U4(100) 切换至 U0(000)
时，只需改变 A 相上下一对切换开关，若由 U4(100) 切换至 U7(111) 则需改变
B、C 相上下两对切换开关，增加了一倍的切换损失。因此要改变电压向量
U4(100)、U2(010)、 U1(001) 的大小，需配合零电压向量 U0(000)，而要改变
U6(110)、U3(011)、U5(100)， 需配合零电压向量
U7(111)。这样通过在不同区间内安排不同的开关切换顺序，
就可以获得对称的输出波形，其它各扇区的开关切换顺序如下表所示： <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-7.png"></p>
<p>现的先后顺序为
U0、U4、U6、U7、U6、U4、U0，各电压向量的三相波形则与上表中的开关表示符号相对应。再下一个
TS 时段，Uref 的角度增加一个γ，利用式上式可以重新计算新的 T0、T4、T6 及
T7 值；这样每一个载波周期 Ts
就会合成一个新的矢量，随着θ的逐渐增大，<span class="math inline"><em>U</em><sub><em>r</em></sub><em>e</em><em>f</em></span>
将依序进入第Ⅰ、Ⅱ、Ⅲ、Ⅳ、Ⅴ、Ⅵ区。在电压向量旋转一周期后，就会产生 R
个合成矢量。</p>
<h3 id="合成矢量u_ref所处扇区-n-的判断">合成矢量<span class="math inline"><em>U</em><sub><em>r</em></sub><em>e</em><em>f</em></span>所处扇区
N 的判断</h3>
<p>空间矢量调制的第一步是判断由 Uα和
Uβ所决定的空间电压矢量所处的扇区。假定合成的电压矢量落在第 I
扇区，可知其等价条件如下：0º &lt; arctan(Uβ/Uα) &lt; 60 º
以上等价条件再结合矢量图几何关系分析，可以判断出合成电压矢量<span class="math inline"><em>U</em><sub><em>r</em></sub><em>e</em><em>f</em></span>落在第
X 扇区的充分必要条件，得出下表： <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-sector.png"></p>
<p>若进一步分析以上的条件，有可看出参考电压矢量<span class="math inline"><em>U</em><sub><em>r</em></sub><em>e</em><em>f</em></span>所在的扇区完全由<span class="math inline">$U_{\beta }, \sqrt{3}U_{\alpha } - U_{\beta
},  -\sqrt{3}U_{\alpha } - U_{\beta }$</span>三式决定，因此令：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;U_1 = U_{\beta} \\
&amp;U_2 = \sqrt{3}U_{\alpha } - U_{\beta } \\
&amp;U_3 = -\sqrt{3}U_{\alpha } - U_{\beta }
\end{aligned}
$$</span></p>
<p>再定义，若 U1&gt;0 ，则 A=1，否则 A=0； 若 U 2&gt;0 ，则 B=1，否则
B=0；若 U3&gt;0 ，则 C=1，否则 C=0。可以看出 A，B，C
之间共有八种组合，但由判断扇区的公式可知 A，B，C 不会同时为 1 或同时为
0，所以实际的组合是六种，A，B，C 组合取不同的值对
应着不同的扇区，并且是一一对应的，因此完全可以由 A，B，C
的组合判断所在的扇区。为区别六种状态，令 N=4 * C + 2 * B +
A，则可以通过下表计算参考电压 矢量 Uref 所在的扇区。 <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-sectorx.png"></p>
<p>采用上述方法，只需经过简单的加减及逻辑运算即可确定所在的扇区，对于提高系统的响应速度和进行仿真都是很有意义的。</p>
<h3 id="基本矢量作用时间计算">基本矢量作用时间计算</h3>
<p>在传统 SVPWM
算法中用到了空间角度及三角函数，使得直接计算基本电压矢量作用时间变得十分困难。实际上只要充分利用
Uα 和 Uβ 就可以使计算大为简化。以 Uref 处在第Ⅰ扇区时进行分析有：</p>
<p><span class="math display">$$
\begin{bmatrix}U_{\alpha }\\ U_{\beta }\end{bmatrix} =
U_{ref}\begin{bmatrix}cos(\theta )\\ sin(\theta )\end{bmatrix} T_s =
\frac{2}{3}U_{dc}\left ( \begin{bmatrix}1\\ 0\end{bmatrix} T_4 +
\begin{bmatrix}cos(\frac{\pi }{3})\\ sin(\frac{\pi }{3})\end{bmatrix}
T_6\right )
$$</span></p>
<p>经过整理后得出：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;U_{\alpha } T_s = \frac{2}{3}U_{dc}(T_4 + \frac{1}{2}T_6) \\
&amp;U_{\beta } T_s = \frac{2}{3}U_{dc}(\frac{\sqrt{3}}{2}T_6)
\end{aligned}
$$</span></p>
<p><span class="math display">$$
\begin{aligned}
&amp;T_4 = \frac{2U_{\alpha } T}{2U_{dc}} - \frac{1}{2}T_6 =
\frac{2U_{\alpha } T_s}{2U_{dc}} - \frac{\sqrt{3}}{2}\frac{U_{\beta
}T_s}{U_{dc}} = \frac{\sqrt{3}T_s}{U_{dc}}U_2 \\
&amp;T_6 = \frac{\sqrt{3} U_{\beta }T_s}{U_{dc}} =
\frac{\sqrt{3}T_s}{U_{dc}}U_1 \\
&amp;T_7 = T_0 = \frac{T_s - T_4 - T_6}{2}
\end{aligned}
$$</span></p>
<p>同理可求得<span class="math inline"><em>U</em><sub><em>r</em></sub><em>e</em><em>f</em></span>在其它扇区中各矢量的作用时间，结果如下表所示。由此可根据前式中的
U1 、U 2 、U3 判断合成矢量所在扇区，然后查表得出两非零矢量的作用时间，
最后得出三相 PWM 波占空比，下表可以使 SVPWM 算法编程简易实现。 <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-time1.png">
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-time2.png"></p>
<p>将 I 扇区的时间图画出来如下： <img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Algorithm/svpwm-time1sector.png"></p>
<h3 id="svpwm-物理含义">SVPWM 物理含义</h3>
<p>SVPWM
实质是一种对在三相正弦波中注入了零序分量的调制波进行规则采样的一种变形
SPWM。但 SVPWM 的调制过程是在空间中实现的，而 SPWM 是在 ABC
坐标系下分相实现的；SPWM 的相电压调制波是正弦波，而 SVPWM
没有明确的相电压调制波，是隐含的。为了揭示 SVPWM 与 SPWM
的内在联系，需求出 SVPWM 在 ABC 坐标系上的等效调制波方程，也就是将 SVPWM
的隐含调制波显化。 我们知道了各扇区的矢量发送顺序： 奇数区依次为：U 0
，U k ，U k+1 ，U 7 ，U k+1 ，U k ，U 0 偶数区依次为：U 0 ，U k+1 ，U k
，U 7 ，U k ，U k+1 ，U 0 利用空间电压矢量近似原理，可总结出下式：</p>
<p><span class="math display">$$
\begin{bmatrix}T_k\\ t_{k+1}\end{bmatrix} = \begin{bmatrix}
sin(\frac{k\pi }{3}) &amp; -cos(\frac{k\pi }{3})\\
sin(\frac{(k -1) \pi }{3}) &amp; -cos(\frac{(k-1)\pi }{3})
\end{bmatrix}\begin{bmatrix}
cos(\theta )\\
sin(\theta )
\end{bmatrix}
$$</span></p>
<p>式中 m 仍为 SVPWM
调制系数，利用以上各式就可得到在第Ⅰ扇区的各相电压平均值：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;U_a(\theta ) = \frac{U_{dc}}{T_s}(-\frac{T_0}{2} + \frac{T_4}{2} +
\frac{T_6}{2} + \frac{T_7}{2} + \frac{T_7}{2} + \frac{T_6}{2} +
\frac{T_4}{2} - \frac{T_0}{2} ) = \frac{\sqrt{3}}{2}\left | U_{ref}
\right | cos(\theta - \frac{\pi }{6}) \\
&amp;U_b(\theta ) = \frac{U_{dc}}{T_s}(-\frac{T_0}{2} + \frac{T_4}{2} +
\frac{T_6}{2} + \frac{T_7}{2} + \frac{T_7}{2} + \frac{T_6}{2} +
\frac{T_4}{2} - \frac{T_0}{2} ) = \frac{\sqrt{3}}{2}\left | U_{ref}
\right | sin(\theta - \frac{\pi }{6}) \\
&amp;U_c(\theta ) = \frac{U_{dc}}{T_s}(-\frac{T_0}{2} + \frac{T_4}{2} +
\frac{T_6}{2} + \frac{T_7}{2} + \frac{T_7}{2} + \frac{T_6}{2} +
\frac{T_4}{2} - \frac{T_0}{2} ) = -\frac{\sqrt{3}}{2}\left | U_{ref}
\right | cos(\theta - \frac{\pi }{6})
\end{aligned}
$$</span></p>
<p>同样可以推导出其它扇区的调制波函数，其相电压调制函数如下：</p>
<p><span class="math display">$$
U_a(\theta ) = \left\{\begin{matrix}
\frac{\sqrt{3}}{2}\left | U_{ref} \right | cos(\theta - \frac{\pi }{6})
---(0 \leqslant  \theta &lt; \frac{\pi }{3}, \pi \leqslant \theta &lt;
\frac{4\pi }{3})\\
\frac{\sqrt{3}}{2}\left | U_{ref} \right | cos(\theta ) ---(\frac{\pi
}{3}\leqslant \theta &lt; \frac{2\pi }{3}, \frac{4\pi }{3} \leqslant
\theta &lt; \frac{5\pi }{3})\\
\frac{\sqrt{3}}{2}\left | U_{ref} \right | cos(\theta + \frac{\pi }{6})
---(\frac{2\pi }{3} \leqslant  \theta &lt; \pi , \frac{5\pi }{3}
\leqslant \theta &lt; 2\pi )
\end{matrix}\right. \\
U_b(\theta ) = U_a(\theta - \frac{2\pi }{3}) \\
U_c(\theta ) = U_a(\theta - \frac{4\pi }{3})
$$</span></p>
<p>其线电压的调制波函数为：</p>
<p><span class="math display">$$
\begin{aligned}
&amp;U_{ab}(\theta) = U_a(\theta) - U_b(\theta) = \sqrt{3 } \left|
U_{ref} \right |sin(\theta + \frac{\pi }{3}) \\
&amp;U_{bc}(\theta ) = U_{ab}(\theta - \frac{2\pi }{3}) \\
&amp;U_{ca}(\theta ) = U_{a}(\theta - \frac{4\pi }{3})
\end{aligned}
$$</span></p>
<p>从相电压调制波函数来看，输出的是不规则的分段函数，为马鞍波形。当调制波为正弦波时为
spwm，调制波为在理想正弦波基础上加入三次谐波注入就是
svpwm。比单纯正弦调制波输出的 SPWM，SVPWM 的优点：</p>
<ul>
<li>谐波优化程度高，转矩脉动小</li>
<li>通过共模分量注入，等效基波增大，电压利用率提高</li>
</ul>
<p>odriver的实现 [[odriverSVM]]</p>
<h1 id="开环控制">开环控制</h1>
<p>对于一个完整当 FOC
控制器是需要电流采样的，只有在有电流采样的情况下才可以进行 clark
变换，而在实际的使用过程中有时我们并不需要进行电流闭环控制，可以采用开环控制算法，那么在没有电流反馈的情况下该如何进行开环控制呢？这里可以将
clark 变换和 park 变换省略掉，直接对 dq 轴变量进行调控，然后直接进行反
park 变换回去，再经过 svpwm
模块输出最终的信号给到电机。这里的开环控制跟有感还是无感是没有关系的，这里让然可以采用有感的开环控制，只是这里就没有办法做电流闭环控制，只能做力矩，速度和位置闭环控制。</p>
<p>odriver的speed控制参考 [[odriverSpeed]]</p>
<h1 id="其他算法">其他算法</h1>
<p>其他算法可以参考 [[focRelatedAlgorithms]]</p>
<h1 id="总结">总结</h1>
<p>回到一开始的 FOC 控制总体框图，整个 FOC
流程是通过电流采样获得三相电流值，对三相电流值进行 clark 变换到<span class="math inline"><em>α</em><em>β</em></span>坐标系下（两相直角坐标系），再经过
park 变换，变换到转子的 dq
坐标系下，到这里交流信号已经转变为直流信号，然后对这个直流信号进行调节，一般采用
pid 控制器进行调节，可以进行力矩，速度和位置闭环调节，将调节后对 dq
坐标轴数据再经过反 park 变换再经过 svpwm 运算后输出 pwm
信号到电机，这就是完整对 foc 控制算法。</p>
<h2 id="参考文献">参考文献</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cucGVuZ2t5LmNuL3lvbmdjaURKLzA0LXd1c2h1YVlDRERKLVlMMTEvd3VzaHVhWUNESi1ZTDExLmh0bWw=">二相导通星形三相六状态无刷直流永磁电动机工作原理<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yOTM0NzA5MTI=">Clark 变换与 Park
变换<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80Nzc2NjQ1Mg==">如何深入理解
SVPWM？<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzIzNTY3NzA3">三相对称电流通过向 dq
坐标轴上投影得到的 Id、Iq 与通过 park 变换得到的 Id、Iq
有什么区别和联系么？<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNDc2NTk4MjA=">深入浅出讲解 FOC 算法与
SVPWM 技术<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hkdWNvbGxpbnMvYXJ0aWNsZS9kZXRhaWxzLzc5MjYwMTc2">永磁同步电机
(PMSM) 的 FOC 闭环控制详解<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMTczNDczNTE=">克拉克 (Clark)
变换中等幅值 (2/3) 和等功率 (sqrt(2/3)) 变换的公式推导<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cDovL2ZpbGUuZWxlY2ZhbnMuY29tL3dlYjEvTTAwLzdGL0Q0L3BJWUJBRndtOXZpQURITE5BQVNNUWE1ZlZuZzQ2Ny5wZGY=">SVPWM
技术<i class="fa fa-external-link-alt"></i></span></p>

      </div>
      
      
      
    </div>
  <ul class="breadcrumb">
            <li><a href="/note/">NOTE</a></li>
            <li><a href="/note/Blog/">BLOG</a></li>
            <li><a href="/note/Blog/Algorithm/">ALGORITHM</a></li>
            <li>FOCPRINCIPLE</li>
  </ul>

    
    


    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2018 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">CarlyleLiu</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">488k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">29:35</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nhcmx5bGVsaXU=" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://waline.carlyleliu.vip","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"(发表评论)","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":["nick"],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/note/Blog/Algorithm/focPrinciple.html"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

</body>
</html>
