<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="5txRYykRNG5Z1NrO_ZCLF1GZWnbFmCOLdJHGBVFuCIg">
  <meta name="baidu-site-verification" content="code-XfgDErPTZS">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Reddit+Mono:300,300italic,400,400italic,700,700italic%7CNoto+Sans:300,300italic,400,400italic,700,700italic%7COpen+Sans:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/black/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"carlyleliu.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.20.0","exturl":true,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"hide","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="PCM (digital audio) plugins PCM plugins extends functionality and features of PCM devices. The plugins take care about various sample conversions, sample copying among channels and so on.">
<meta property="og:type" content="website">
<meta property="og:title" content="Linux 驱动之 ALSA（八）Alsa Plugin">
<meta property="og:url" content="https://carlyleliu.github.io/note/Blog/LinuxDriver/LinuxAudioALSAPlugin.html">
<meta property="og:site_name" content="Matrix">
<meta property="og:description" content="PCM (digital audio) plugins PCM plugins extends functionality and features of PCM devices. The plugins take care about various sample conversions, sample copying among channels and so on.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Audio/snd_pcm_dsnoop_open.png">
<meta property="og:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Audio/snd_pcm_readi.png">
<meta property="article:published_time" content="2024-02-26T14:42:52.000Z">
<meta property="article:modified_time" content="2025-09-27T03:40:43.583Z">
<meta property="article:author" content="CarlyleLiu">
<meta property="article:tag" content="Audio">
<meta property="article:tag" content="ALSA">
<meta property="article:tag" content="Driver">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Audio/snd_pcm_dsnoop_open.png">


<link rel="canonical" href="https://carlyleliu.github.io/note/Blog/LinuxDriver/LinuxAudioALSAPlugin">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":false,"lang":"zh-CN","comments":true,"permalink":"https://carlyleliu.github.io/note/Blog/LinuxDriver/LinuxAudioALSAPlugin.html","path":"note/Blog/LinuxDriver/LinuxAudioALSAPlugin.html","title":"Linux 驱动之 ALSA（八）Alsa Plugin"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Linux 驱动之 ALSA（八）Alsa Plugin | Matrix
</title>
  







<link rel="dns-prefetch" href="https://waline.carlyleliu.vip">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Matrix" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Matrix</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">CarlyleLiu‘s Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-alist"><span class="exturl" data-url="aHR0cHM6Ly9hbGlzdC5jYXJseWxlbGl1LnZpcC8="><i class="fa-solid fa-cloud fa-fw"></i>网盘</span></li><li class="menu-item menu-item-books"><span class="exturl" data-url="aHR0cHM6Ly9jYWxpYnJlLmNhcmx5bGVsaXUudmlwLw=="><i class="fa-solid fa-book fa-fw"></i>书库</span></li><li class="menu-item menu-item-talk"><span class="exturl" data-url="aHR0cHM6Ly9tZW1vcy5jYXJseWxlbGl1LnZpcC9leHBsb3JlLw=="><i class="fas fa-comments fa-fw"></i>随笔</span></li><li class="menu-item menu-item-album"><span class="exturl" data-url="aHR0cHM6Ly9pbW1pY2guY2FybHlsZWxpdS52aXAvc2hhcmUvSmtSenVqZERfdWVJRnJRNHpvYnpfUW1EVndRZkdGS3ZyVTh0ZlJIYWN1ZG9ZMjV0Z2tFdDd6aS1Wck5oYUEzZUdpNC8="><i class="fa-solid fa-image fa-fw"></i>相册</span></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#pcm-digital-audio-plugins"><span class="nav-text"> PCM (digital audio) plugins</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugin-hw"><span class="nav-text"> Plugin: hw</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#slave-definition"><span class="nav-text"> Slave definition</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugin-rate"><span class="nav-text"> Plugin: Rate</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugin-route-volume"><span class="nav-text"> Plugin: Route &amp; Volume</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#automatic-conversion-plugin"><span class="nav-text"> Automatic conversion plugin</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugin-multiple-streams-to-one"><span class="nav-text"> Plugin: Multiple streams to One</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugin-dmix"><span class="nav-text"> Plugin: dmix</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugin-dsnoop"><span class="nav-text"> Plugin: dsnoop</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#open-%E6%B5%81%E7%A8%8B"><span class="nav-text"> Open 流程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#read-%E6%B5%81%E7%A8%8B"><span class="nav-text"> Read 流程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="nav-text"> 参考文献</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CarlyleLiu</p>
  <div class="site-description" itemprop="description">CarlyleLiu’s Blog</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">207</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nhcmx5bGVsaXU=" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;carlyleliu"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnl5bGl1c2h1YWlAZ21haWwuY29t" title="E-Mail → mailto:yyliushuai@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95eWxpdXNodWFp" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;yyliushuai"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly95b3V0dWJlLmNvbS9jYXJseWxlbGl1" title="YouTube → https:&#x2F;&#x2F;youtube.com&#x2F;carlyleliu"><i class="fab fa-youtube fa-fw"></i>YouTube</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9pbnN0YWdyYW0uY29tL2JsdXJyZWRsaXU=" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;blurredliu"><i class="fab fa-instagram fa-fw"></i>Instagram</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC96aC1DTg=="><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
    </div>

    
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner page posts-expand">


    
    
    
    <div class="post-block" lang="zh-CN"><header class="post-header">

<h1 class="post-title" itemprop="name headline">Linux 驱动之 ALSA（八）Alsa Plugin
</h1>

<div class="post-meta-container">
  <ul class="breadcrumb">
            <li><a href="/note/">NOTE</a></li>
            <li><a href="/note/Blog/">BLOG</a></li>
            <li><a href="/note/Blog/LinuxDriver/">LINUXDRIVER</a></li>
            <li>LINUXAUDIOALSAPLUGIN</li>
  </ul>
</div>

</header>

      
      
      
      <div class="post-body">
          <h1 id="pcm-digital-audio-plugins"><a class="markdownIt-Anchor" href="#pcm-digital-audio-plugins"></a> PCM (digital audio) plugins</h1>
<p>PCM plugins extends functionality and features of PCM devices. The plugins take care about various sample conversions, sample copying among channels and so on.</p>
<span id="more"></span>
<h1 id="plugin-hw"><a class="markdownIt-Anchor" href="#plugin-hw"></a> Plugin: hw</h1>
<p>This plugin communicates directly with the ALSA kernel driver. It is a raw communication without any conversions. The emulation of mmap access can be optionally enabled, but expect worse latency in the case.</p>
<p>The nonblock option specifies whether the device is opened in a non-blocking manner. Note that the blocking behavior for read/write access won’t be changed by this option. This influences only on the blocking behavior at opening the device. If you would like to keep the compatibility with the older ALSA stuff, turn this option off.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">    <span class="built_in">type</span> hw         <span class="comment"># Kernel PCM</span></span><br><span class="line">    card INT/STR        <span class="comment"># Card name (string) or number (integer)</span></span><br><span class="line">    [device INT]        <span class="comment"># Device number (default 0)</span></span><br><span class="line">    [subdevice INT]     <span class="comment"># Subdevice number (default -1: first available)</span></span><br><span class="line">    [sync_ptr_ioctl BOOL]   <span class="comment"># Use SYNC_PTR ioctl rather than the direct mmap access for control structures</span></span><br><span class="line">    [nonblock BOOL]     <span class="comment"># Force non-blocking open mode</span></span><br><span class="line">    [format STR]        <span class="comment"># Restrict only to the given format</span></span><br><span class="line">    [channels INT]      <span class="comment"># Restrict only to the given channels</span></span><br><span class="line">    [rate INT]      <span class="comment"># Restrict only to the given rate</span></span><br><span class="line">    [chmap MAP]     <span class="comment"># Override channel maps; MAP is a string array</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Example:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pcm.!default{</span><br><span class="line">    <span class="built_in">type</span> hw</span><br><span class="line">    card 0</span><br><span class="line">    device 1</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">ctl.!default{</span><br><span class="line">    <span class="built_in">type</span> hw</span><br><span class="line">    card 0</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">pcm.microphone {</span><br><span class="line">    <span class="built_in">type</span> hw</span><br><span class="line">    card 0</span><br><span class="line">    device 2</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">pcm.avs_input {</span><br><span class="line">    <span class="built_in">type</span> hw</span><br><span class="line">    card 0</span><br><span class="line">    device 4</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>给 hw:0,1 设备重命名为 default</p>
<p>Test：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aplay -D default test.wav</span><br></pre></td></tr></tbody></table></figure>
<h1 id="slave-definition"><a class="markdownIt-Anchor" href="#slave-definition"></a> Slave definition</h1>
<p>The slave plugin can be specified directly with a string or the definition can be entered inside a compound configuration node. Some restrictions can be also specified (like static rate or count of channels).</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pcm_slave.NAME {</span><br><span class="line">    pcm STR     <span class="comment"># PCM name</span></span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    pcm { }     <span class="comment"># PCM definition</span></span><br><span class="line">    format STR  <span class="comment"># Format or "unchanged"</span></span><br><span class="line">    channels INT    <span class="comment"># Count of channels or "unchanged" string</span></span><br><span class="line">    rate INT    <span class="comment"># Rate in Hz or "unchanged" string</span></span><br><span class="line">    period_time INT <span class="comment"># Period time in us or "unchanged" string</span></span><br><span class="line">    buffer_time INT <span class="comment"># Buffer time in us or "unchanged" string</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Example:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pcm_slave.slave_rate44100Hz {</span><br><span class="line">    pcm <span class="string">"hw:0,0"</span></span><br><span class="line">    rate 44100</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">pcm.rate44100Hz {</span><br><span class="line">    <span class="built_in">type</span> plug</span><br><span class="line">    slave slave_rate44100Hz</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The equivalent configuration (in one compound):</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pcm.rate44100Hz {</span><br><span class="line">    <span class="built_in">type</span> plug</span><br><span class="line">    slave {</span><br><span class="line">        pcm <span class="string">"hw:0,0"</span></span><br><span class="line">        rate 44100</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>将 hw:0,0 声卡的采样频率转换为 44100hz。</strong></p>
<p>Test：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aplay -D rate44100Hz test.wav</span><br></pre></td></tr></tbody></table></figure>
<h1 id="plugin-rate"><a class="markdownIt-Anchor" href="#plugin-rate"></a> Plugin: Rate</h1>
<p>This plugin converts a stream rate. The input and output formats must be linear.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">    <span class="built_in">type</span> rate               <span class="comment"># Rate PCM</span></span><br><span class="line">        slave STR               <span class="comment"># Slave name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        slave {                 <span class="comment"># Slave definition</span></span><br><span class="line">                pcm STR         <span class="comment"># Slave PCM name</span></span><br><span class="line">                <span class="comment"># or</span></span><br><span class="line">                pcm { }         <span class="comment"># Slave PCM definition</span></span><br><span class="line">                rate INT        <span class="comment"># Slave rate</span></span><br><span class="line">                [format STR]    <span class="comment"># Slave format</span></span><br><span class="line">        }</span><br><span class="line">    converter STR           <span class="comment"># optional</span></span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    converter [ STR1 STR2 ... ] <span class="comment"># optional</span></span><br><span class="line">                <span class="comment"># Converter type, default is taken from</span></span><br><span class="line">                <span class="comment"># defaults.pcm.rate_converter</span></span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    converter {     <span class="comment"># optional</span></span><br><span class="line">        name STR    <span class="comment"># Convertor type</span></span><br><span class="line">        xxx yyy     <span class="comment"># optional convertor-specific configuration</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="plugin-route-volume"><a class="markdownIt-Anchor" href="#plugin-route-volume"></a> Plugin: Route &amp; Volume</h1>
<p>This plugin converts channels and applies volume during the conversion. The format and rate must match for both of them.</p>
<p>SCHANNEL can be a channel name instead of a number (e g FL, LFE). If so, a matching channel map will be selected for the slave.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">        <span class="built_in">type</span> route              <span class="comment"># Route &amp; Volume conversion PCM</span></span><br><span class="line">        slave STR               <span class="comment"># Slave name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        slave {                 <span class="comment"># Slave definition</span></span><br><span class="line">                pcm STR         <span class="comment"># Slave PCM name</span></span><br><span class="line">                <span class="comment"># or</span></span><br><span class="line">                pcm { }         <span class="comment"># Slave PCM definition</span></span><br><span class="line">                [format STR]    <span class="comment"># Slave format</span></span><br><span class="line">                [channels INT]  <span class="comment"># Slave channels</span></span><br><span class="line">        }</span><br><span class="line">        ttable {                <span class="comment"># Transfer table (bi-dimensional compound of cchannels * schannels numbers)</span></span><br><span class="line">                CCHANNEL {</span><br><span class="line">                        SCHANNEL REAL   <span class="comment"># route value (0.0 - 1.0)</span></span><br><span class="line">                }</span><br><span class="line">        }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="automatic-conversion-plugin"><a class="markdownIt-Anchor" href="#automatic-conversion-plugin"></a> Automatic conversion plugin</h1>
<p>This plugin converts channels, rate and format on request.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">        <span class="built_in">type</span> plug               <span class="comment"># Automatic conversion PCM</span></span><br><span class="line">        slave STR               <span class="comment"># Slave name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        slave {                 <span class="comment"># Slave definition</span></span><br><span class="line">                pcm STR         <span class="comment"># Slave PCM name</span></span><br><span class="line">                <span class="comment"># or</span></span><br><span class="line">                pcm { }         <span class="comment"># Slave PCM definition</span></span><br><span class="line">        [format STR]    <span class="comment"># Slave format (default nearest) or "unchanged"</span></span><br><span class="line">        [channels INT]  <span class="comment"># Slave channels (default nearest) or "unchanged"</span></span><br><span class="line">        [rate INT]  <span class="comment"># Slave rate (default nearest) or "unchanged"</span></span><br><span class="line">        }</span><br><span class="line">    route_policy STR    <span class="comment"># route policy for automatic ttable generation</span></span><br><span class="line">                <span class="comment"># STR can be 'default', 'average', 'copy', 'duplicate'</span></span><br><span class="line">                <span class="comment"># average: result is average of input channels</span></span><br><span class="line">                <span class="comment"># copy: only first channels are copied to destination</span></span><br><span class="line">                <span class="comment"># duplicate: duplicate first set of channels</span></span><br><span class="line">                <span class="comment"># default: copy policy, except for mono capture - sum</span></span><br><span class="line">    ttable {        <span class="comment"># Transfer table (bi-dimensional compound of cchannels * schannels numbers)</span></span><br><span class="line">        CCHANNEL {</span><br><span class="line">            SCHANNEL REAL   <span class="comment"># route value (0.0 - 1.0)</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    rate_converter STR  <span class="comment"># type of rate converter</span></span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    rate_converter [ STR1 STR2 ... ]</span><br><span class="line">                <span class="comment"># type of rate converter</span></span><br><span class="line">                <span class="comment"># default value is taken from defaults.pcm.rate_converter</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Example：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pcm.nfbtout {</span><br><span class="line">        <span class="built_in">type</span> plug</span><br><span class="line">        slave {</span><br><span class="line">                pcm <span class="string">"hw:1,0"</span></span><br><span class="line">                rate 8000</span><br><span class="line">                channels 2</span><br><span class="line">        }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="plugin-multiple-streams-to-one"><a class="markdownIt-Anchor" href="#plugin-multiple-streams-to-one"></a> Plugin: Multiple streams to One</h1>
<p>This plugin converts multiple streams to one.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">        <span class="built_in">type</span> multi              <span class="comment"># Multiple streams conversion PCM</span></span><br><span class="line">        slaves {        <span class="comment"># Slaves definition</span></span><br><span class="line">        ID STR      <span class="comment"># Slave PCM name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        ID {</span><br><span class="line">            pcm STR     <span class="comment"># Slave PCM name</span></span><br><span class="line">            <span class="comment"># or</span></span><br><span class="line">            pcm { }     <span class="comment"># Slave PCM definition</span></span><br><span class="line">            channels INT    <span class="comment"># Slave channels</span></span><br><span class="line">        }</span><br><span class="line">    bindings {      <span class="comment"># Bindings table</span></span><br><span class="line">        N {</span><br><span class="line">            slave STR   <span class="comment"># Slave key</span></span><br><span class="line">            channel INT <span class="comment"># Slave channel</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    [master INT]        <span class="comment"># Define the master slave</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>For example, to bind two PCM streams with two-channel stereo (hw:0,0 and hw:0,1) as one 4-channel stereo PCM stream, define like this:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pcm.quad {</span><br><span class="line">    <span class="built_in">type</span> multi</span><br><span class="line"> </span><br><span class="line">    slaves.a.pcm <span class="string">"hw:0,0"</span></span><br><span class="line">    slaves.a.channels 2</span><br><span class="line">    slaves.b.pcm <span class="string">"hw:0,1"</span></span><br><span class="line">    slaves.b.channels 2</span><br><span class="line"> </span><br><span class="line">    bindings.0.slave a</span><br><span class="line">    bindings.0.channel 0</span><br><span class="line">    bindings.1.slave a</span><br><span class="line">    bindings.1.channel 1</span><br><span class="line">    bindings.2.slave b</span><br><span class="line">    bindings.2.channel 0</span><br><span class="line">    bindings.3.slave b</span><br><span class="line">    bindings.3.channel 1</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Note that the resultant pcm “quad” is not in the interleaved format but in the “complex” format. Hence, it’s not accessible by applications which can handle only the interleaved (or the non-interleaved) format. In such a case, wrap this PCM with&nbsp;route&nbsp;or&nbsp;plug&nbsp;plugin.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pcm.quad2 {</span><br><span class="line">    <span class="built_in">type</span> route</span><br><span class="line">    slave.pcm <span class="string">"quad"</span></span><br><span class="line">    ttable.0.0 1</span><br><span class="line">    ttable.1.1 1</span><br><span class="line">    ttable.2.2 1</span><br><span class="line">    ttable.3.3 1</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="plugin-dmix"><a class="markdownIt-Anchor" href="#plugin-dmix"></a> Plugin: dmix</h1>
<p>This plugin provides direct mixing of multiple streams. The resolution for 32-bit mixing is only 24-bit. The low significant byte is filled with zeros. The extra 8 bits are used for the saturation.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">    <span class="built_in">type</span> dmix       <span class="comment"># Direct mix</span></span><br><span class="line">    ipc_key INT     <span class="comment"># unique IPC key</span></span><br><span class="line">    ipc_key_add_uid BOOL    <span class="comment"># add current uid to unique IPC key</span></span><br><span class="line">    ipc_perm INT        <span class="comment"># IPC permissions (octal, default 0600)</span></span><br><span class="line">    hw_ptr_alignment STR    <span class="comment"># Slave application and hw pointer alignment type</span></span><br><span class="line">                <span class="comment"># STR can be one of the below strings :</span></span><br><span class="line">                <span class="comment"># no</span></span><br><span class="line">                <span class="comment"># roundup</span></span><br><span class="line">                <span class="comment"># rounddown</span></span><br><span class="line">                <span class="comment"># auto (default)</span></span><br><span class="line">    slave STR</span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    slave {         <span class="comment"># Slave definition</span></span><br><span class="line">        pcm STR     <span class="comment"># slave PCM name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        pcm { }     <span class="comment"># slave PCM definition</span></span><br><span class="line">        format STR  <span class="comment"># format definition</span></span><br><span class="line">        rate INT    <span class="comment"># rate definition</span></span><br><span class="line">        channels INT</span><br><span class="line">        period_time INT <span class="comment"># in usec</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        period_size INT <span class="comment"># in bytes</span></span><br><span class="line">        buffer_time INT <span class="comment"># in usec</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        buffer_size INT <span class="comment"># in bytes</span></span><br><span class="line">        periods INT <span class="comment"># when buffer_size or buffer_time is not specified</span></span><br><span class="line">    }</span><br><span class="line">    bindings {      <span class="comment"># note: this is client independent!!!</span></span><br><span class="line">        N INT       <span class="comment"># maps slave channel to client channel N</span></span><br><span class="line">    }</span><br><span class="line">    slowptr BOOL        <span class="comment"># slow but more precise pointer updates</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ipc_key 必须是整数形式的唯一 ipc key。对于每个不同的 dmix 定义，这个数字必须是唯一的，因为共享内存是用这个 key 创建的。当 ipc_key_add_uid 设置为 true 时，uid 值将添加到 ipc_key 设置中。这样可以避免同一个 IPC 密钥与不同用户同时发生冲突。</p>
<p>hw_ptr_alignment 这个配置默认是 auto</p>
<p>An example configuration for setting 44100 Hz,&nbsp;<code>S32_LE</code>&nbsp;format as the slave PCM of “hw:0” is like below:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pcm.dmix_44 {</span><br><span class="line">    <span class="built_in">type</span> dmix</span><br><span class="line">    ipc_key 321456  <span class="comment"># any unique value</span></span><br><span class="line">    ipc_key_add_uid <span class="literal">true</span></span><br><span class="line">    slave {</span><br><span class="line">        pcm <span class="string">"hw:0"</span></span><br><span class="line">        format S32_LE</span><br><span class="line">        rate 44100</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Test：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aplay -Dplug:dmix_44 foo_48k.wav</span><br></pre></td></tr></tbody></table></figure>
<h1 id="plugin-dsnoop"><a class="markdownIt-Anchor" href="#plugin-dsnoop"></a> Plugin: dsnoop</h1>
<p>此插件将一个 capture 流拆分为多个。它的工作方式与 dmix 插件相反，从多个客户端同时读取共享捕获缓冲区。以下参数的含义与 dmix 插件几乎相同。</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">    <span class="built_in">type</span> dsnoop     <span class="comment"># Direct snoop</span></span><br><span class="line">    ipc_key INT     <span class="comment"># unique IPC key</span></span><br><span class="line">    ipc_key_add_uid BOOL    <span class="comment"># add current uid to unique IPC key</span></span><br><span class="line">    ipc_perm INT        <span class="comment"># IPC permissions (octal, default 0600)</span></span><br><span class="line">    slave STR</span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    slave {         <span class="comment"># Slave definition</span></span><br><span class="line">        pcm STR     <span class="comment"># slave PCM name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        pcm { }     <span class="comment"># slave PCM definition</span></span><br><span class="line">        format STR  <span class="comment"># format definition</span></span><br><span class="line">        rate INT    <span class="comment"># rate definition</span></span><br><span class="line">        channels INT</span><br><span class="line">        period_time INT <span class="comment"># in usec</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        period_size INT <span class="comment"># in bytes</span></span><br><span class="line">        buffer_time INT <span class="comment"># in usec</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        buffer_size INT <span class="comment"># in bytes</span></span><br><span class="line">        periods INT <span class="comment"># when buffer_size or buffer_time is not specified</span></span><br><span class="line">    }</span><br><span class="line">    bindings {      <span class="comment"># note: this is client independent!!!</span></span><br><span class="line">        N INT       <span class="comment"># maps slave channel to client channel N</span></span><br><span class="line">    }</span><br><span class="line">    slowptr BOOL        <span class="comment"># slow but more precise pointer updates</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="open-流程"><a class="markdownIt-Anchor" href="#open-流程"></a> Open 流程</h1>
<p>下面以 dsnoop 插件为例梳理下 alsa-lib 使用插件的流程，详细如下：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cucHJvY2Vzc29uLmNvbS92aWV3L2xpbmsvNjVkYjA5N2E1YTQ4YmMwMjc2ODg4MzNk">原图<i class="fa fa-external-link-alt"></i></span><br>
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Audio/snd_pcm_dsnoop_open.png" alt=""></p>
<ul>
<li>解析配置文件并生成配置树</li>
<li>打开实际设备，通过 mmap 映射驱动中的控制信息和 buffer</li>
</ul>
<h1 id="read-流程"><a class="markdownIt-Anchor" href="#read-流程"></a> Read 流程</h1>
<p>以下是 read 流程，write 流程不再列出来了。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cucHJvY2Vzc29uLmNvbS92aWV3L2xpbmsvNjVkYjA5YWM5YTM0M2QzZTg5OWQ5MTgy">原图<i class="fa fa-external-link-alt"></i></span><br>
<img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Audio/snd_pcm_readi.png" alt=""></p>
<ul>
<li>memcopy 驱动 DMA buffer 中的数据</li>
<li>hw_ptr 数据指针的 sync</li>
</ul>
<p>可以看到 alsa plug 支持多进程，可以多个进程打开同一个 slave 声卡，多进程间通过信号量同步。<br>
如果要自己创建一个声卡，同时让创建的声卡支持 plugin，那么最好不要使用 appl_ptr 和依赖 appl_ptr 的 api。</p>
<h1 id="参考文献"><a class="markdownIt-Anchor" href="#参考文献"></a> 参考文献</h1>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYWxzYS1wcm9qZWN0Lm9yZy9hbHNhLWRvYy9hbHNhLWxpYi9wY21fcGx1Z2lucy5odG1s">https://www.alsa-project.org/alsa-doc/alsa-lib/pcm_plugins.html<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9hbHNhLm9wZW5zcmMub3JnL0FMU0FfcGx1Z2lucw==">https://alsa.opensrc.org/ALSA_plugins<i class="fa fa-external-link-alt"></i></span></p>

      </div>
      
      
      
    </div>
  <ul class="breadcrumb">
            <li><a href="/note/">NOTE</a></li>
            <li><a href="/note/Blog/">BLOG</a></li>
            <li><a href="/note/Blog/LinuxDriver/">LINUXDRIVER</a></li>
            <li>LINUXAUDIOALSAPLUGIN</li>
  </ul>

    
    


    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2018 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">CarlyleLiu</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">488k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">29:35</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nhcmx5bGVsaXU=" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://waline.carlyleliu.vip","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"(发表评论)","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":["nick"],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/note/Blog/LinuxDriver/LinuxAudioALSAPlugin.html"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

</body>
</html>
