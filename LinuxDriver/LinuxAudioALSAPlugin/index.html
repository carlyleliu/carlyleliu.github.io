<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Linux 驱动之 ALSA（八）Alsa Plugin | Matrix</title><meta name="author" content="CarlyleLiu"><meta name="copyright" content="CarlyleLiu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="PCM (digital audio) pluginsPCM plugins extends functionality and features of PCM devices. The plugins take care about various sample conversions, sample copying among channels and so on.">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 驱动之 ALSA（八）Alsa Plugin">
<meta property="og:url" content="https://carlyleliu.github.io/LinuxDriver/LinuxAudioALSAPlugin/index.html">
<meta property="og:site_name" content="Matrix">
<meta property="og:description" content="PCM (digital audio) pluginsPCM plugins extends functionality and features of PCM devices. The plugins take care about various sample conversions, sample copying among channels and so on.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://unsplash.it/1600/900?random&1597">
<meta property="article:published_time" content="2024-02-26T14:42:52.000Z">
<meta property="article:modified_time" content="2025-09-27T04:36:15.389Z">
<meta property="article:author" content="CarlyleLiu">
<meta property="article:tag" content="Audio">
<meta property="article:tag" content="ALSA">
<meta property="article:tag" content="Driver">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://unsplash.it/1600/900?random&1597"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://carlyleliu.github.io/LinuxDriver/LinuxAudioALSAPlugin/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Linux 驱动之 ALSA（八）Alsa Plugin',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-09-27 12:36:15'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Matrix" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">194</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://unsplash.it/1600/900?random&amp;1597')"><nav id="nav"><span id="blog-info"><a href="/" title="Matrix"><span class="site-name">Matrix</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Linux 驱动之 ALSA（八）Alsa Plugin</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-02-26T14:42:52.000Z" title="发表于 2024-02-26 22:42:52">2024-02-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-27T04:36:15.389Z" title="更新于 2025-09-27 12:36:15">2025-09-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Technology-Blog/Audio/">Audio</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Linux 驱动之 ALSA（八）Alsa Plugin"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="PCM-digital-audio-plugins"><a href="#PCM-digital-audio-plugins" class="headerlink" title="PCM (digital audio) plugins"></a>PCM (digital audio) plugins</h1><p>PCM plugins extends functionality and features of PCM devices. The plugins take care about various sample conversions, sample copying among channels and so on.</p>
<span id="more"></span>
<h1 id="Plugin-hw"><a href="#Plugin-hw" class="headerlink" title="Plugin: hw"></a>Plugin: hw</h1><p>This plugin communicates directly with the ALSA kernel driver. It is a raw communication without any conversions. The emulation of mmap access can be optionally enabled, but expect worse latency in the case.</p>
<p>The nonblock option specifies whether the device is opened in a non-blocking manner. Note that the blocking behavior for read/write access won’t be changed by this option. This influences only on the blocking behavior at opening the device. If you would like to keep the compatibility with the older ALSA stuff, turn this option off.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">    <span class="built_in">type</span> hw         <span class="comment"># Kernel PCM</span></span><br><span class="line">    card INT/STR        <span class="comment"># Card name (string) or number (integer)</span></span><br><span class="line">    [device INT]        <span class="comment"># Device number (default 0)</span></span><br><span class="line">    [subdevice INT]     <span class="comment"># Subdevice number (default -1: first available)</span></span><br><span class="line">    [sync_ptr_ioctl BOOL]   <span class="comment"># Use SYNC_PTR ioctl rather than the direct mmap access for control structures</span></span><br><span class="line">    [nonblock BOOL]     <span class="comment"># Force non-blocking open mode</span></span><br><span class="line">    [format STR]        <span class="comment"># Restrict only to the given format</span></span><br><span class="line">    [channels INT]      <span class="comment"># Restrict only to the given channels</span></span><br><span class="line">    [rate INT]      <span class="comment"># Restrict only to the given rate</span></span><br><span class="line">    [chmap MAP]     <span class="comment"># Override channel maps; MAP is a string array</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Example:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pcm.!default{</span><br><span class="line">    <span class="built_in">type</span> hw</span><br><span class="line">    card 0</span><br><span class="line">    device 1</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">ctl.!default{</span><br><span class="line">    <span class="built_in">type</span> hw</span><br><span class="line">    card 0</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">pcm.microphone {</span><br><span class="line">    <span class="built_in">type</span> hw</span><br><span class="line">    card 0</span><br><span class="line">    device 2</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">pcm.avs_input {</span><br><span class="line">    <span class="built_in">type</span> hw</span><br><span class="line">    card 0</span><br><span class="line">    device 4</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>给 hw:0,1 设备重命名为 default</p>
<p>Test：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aplay -D default test.wav</span><br></pre></td></tr></tbody></table></figure>
<h1 id="Slave-definition"><a href="#Slave-definition" class="headerlink" title="Slave definition"></a>Slave definition</h1><p>The slave plugin can be specified directly with a string or the definition can be entered inside a compound configuration node. Some restrictions can be also specified (like static rate or count of channels).</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pcm_slave.NAME {</span><br><span class="line">    pcm STR     <span class="comment"># PCM name</span></span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    pcm { }     <span class="comment"># PCM definition</span></span><br><span class="line">    format STR  <span class="comment"># Format or "unchanged"</span></span><br><span class="line">    channels INT    <span class="comment"># Count of channels or "unchanged" string</span></span><br><span class="line">    rate INT    <span class="comment"># Rate in Hz or "unchanged" string</span></span><br><span class="line">    period_time INT <span class="comment"># Period time in us or "unchanged" string</span></span><br><span class="line">    buffer_time INT <span class="comment"># Buffer time in us or "unchanged" string</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Example:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pcm_slave.slave_rate44100Hz {</span><br><span class="line">    pcm <span class="string">"hw:0,0"</span></span><br><span class="line">    rate 44100</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">pcm.rate44100Hz {</span><br><span class="line">    <span class="built_in">type</span> plug</span><br><span class="line">    slave slave_rate44100Hz</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The equivalent configuration (in one compound):</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pcm.rate44100Hz {</span><br><span class="line">    <span class="built_in">type</span> plug</span><br><span class="line">    slave {</span><br><span class="line">        pcm <span class="string">"hw:0,0"</span></span><br><span class="line">        rate 44100</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>将 hw:0,0 声卡的采样频率转换为 44100hz。</strong></p>
<p>Test：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aplay -D rate44100Hz test.wav</span><br></pre></td></tr></tbody></table></figure>
<h1 id="Plugin-Rate"><a href="#Plugin-Rate" class="headerlink" title="Plugin: Rate"></a>Plugin: Rate</h1><p>This plugin converts a stream rate. The input and output formats must be linear.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">    <span class="built_in">type</span> rate               <span class="comment"># Rate PCM</span></span><br><span class="line">        slave STR               <span class="comment"># Slave name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        slave {                 <span class="comment"># Slave definition</span></span><br><span class="line">                pcm STR         <span class="comment"># Slave PCM name</span></span><br><span class="line">                <span class="comment"># or</span></span><br><span class="line">                pcm { }         <span class="comment"># Slave PCM definition</span></span><br><span class="line">                rate INT        <span class="comment"># Slave rate</span></span><br><span class="line">                [format STR]    <span class="comment"># Slave format</span></span><br><span class="line">        }</span><br><span class="line">    converter STR           <span class="comment"># optional</span></span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    converter [ STR1 STR2 ... ] <span class="comment"># optional</span></span><br><span class="line">                <span class="comment"># Converter type, default is taken from</span></span><br><span class="line">                <span class="comment"># defaults.pcm.rate_converter</span></span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    converter {     <span class="comment"># optional</span></span><br><span class="line">        name STR    <span class="comment"># Convertor type</span></span><br><span class="line">        xxx yyy     <span class="comment"># optional convertor-specific configuration</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="Plugin-Route-amp-Volume"><a href="#Plugin-Route-amp-Volume" class="headerlink" title="Plugin: Route &amp; Volume"></a>Plugin: Route &amp; Volume</h1><p>This plugin converts channels and applies volume during the conversion. The format and rate must match for both of them.</p>
<p>SCHANNEL can be a channel name instead of a number (e g FL, LFE). If so, a matching channel map will be selected for the slave.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">        <span class="built_in">type</span> route              <span class="comment"># Route &amp; Volume conversion PCM</span></span><br><span class="line">        slave STR               <span class="comment"># Slave name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        slave {                 <span class="comment"># Slave definition</span></span><br><span class="line">                pcm STR         <span class="comment"># Slave PCM name</span></span><br><span class="line">                <span class="comment"># or</span></span><br><span class="line">                pcm { }         <span class="comment"># Slave PCM definition</span></span><br><span class="line">                [format STR]    <span class="comment"># Slave format</span></span><br><span class="line">                [channels INT]  <span class="comment"># Slave channels</span></span><br><span class="line">        }</span><br><span class="line">        ttable {                <span class="comment"># Transfer table (bi-dimensional compound of cchannels * schannels numbers)</span></span><br><span class="line">                CCHANNEL {</span><br><span class="line">                        SCHANNEL REAL   <span class="comment"># route value (0.0 - 1.0)</span></span><br><span class="line">                }</span><br><span class="line">        }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="Automatic-conversion-plugin"><a href="#Automatic-conversion-plugin" class="headerlink" title="Automatic conversion plugin"></a>Automatic conversion plugin</h1><p>This plugin converts channels, rate and format on request.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">        <span class="built_in">type</span> plug               <span class="comment"># Automatic conversion PCM</span></span><br><span class="line">        slave STR               <span class="comment"># Slave name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        slave {                 <span class="comment"># Slave definition</span></span><br><span class="line">                pcm STR         <span class="comment"># Slave PCM name</span></span><br><span class="line">                <span class="comment"># or</span></span><br><span class="line">                pcm { }         <span class="comment"># Slave PCM definition</span></span><br><span class="line">        [format STR]    <span class="comment"># Slave format (default nearest) or "unchanged"</span></span><br><span class="line">        [channels INT]  <span class="comment"># Slave channels (default nearest) or "unchanged"</span></span><br><span class="line">        [rate INT]  <span class="comment"># Slave rate (default nearest) or "unchanged"</span></span><br><span class="line">        }</span><br><span class="line">    route_policy STR    <span class="comment"># route policy for automatic ttable generation</span></span><br><span class="line">                <span class="comment"># STR can be 'default', 'average', 'copy', 'duplicate'</span></span><br><span class="line">                <span class="comment"># average: result is average of input channels</span></span><br><span class="line">                <span class="comment"># copy: only first channels are copied to destination</span></span><br><span class="line">                <span class="comment"># duplicate: duplicate first set of channels</span></span><br><span class="line">                <span class="comment"># default: copy policy, except for mono capture - sum</span></span><br><span class="line">    ttable {        <span class="comment"># Transfer table (bi-dimensional compound of cchannels * schannels numbers)</span></span><br><span class="line">        CCHANNEL {</span><br><span class="line">            SCHANNEL REAL   <span class="comment"># route value (0.0 - 1.0)</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    rate_converter STR  <span class="comment"># type of rate converter</span></span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    rate_converter [ STR1 STR2 ... ]</span><br><span class="line">                <span class="comment"># type of rate converter</span></span><br><span class="line">                <span class="comment"># default value is taken from defaults.pcm.rate_converter</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Example：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pcm.nfbtout {</span><br><span class="line">        <span class="built_in">type</span> plug</span><br><span class="line">        slave {</span><br><span class="line">                pcm <span class="string">"hw:1,0"</span></span><br><span class="line">                rate 8000</span><br><span class="line">                channels 2</span><br><span class="line">        }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="Plugin-Multiple-streams-to-One"><a href="#Plugin-Multiple-streams-to-One" class="headerlink" title="Plugin: Multiple streams to One"></a>Plugin: Multiple streams to One</h1><p>This plugin converts multiple streams to one.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">        <span class="built_in">type</span> multi              <span class="comment"># Multiple streams conversion PCM</span></span><br><span class="line">        slaves {        <span class="comment"># Slaves definition</span></span><br><span class="line">        ID STR      <span class="comment"># Slave PCM name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        ID {</span><br><span class="line">            pcm STR     <span class="comment"># Slave PCM name</span></span><br><span class="line">            <span class="comment"># or</span></span><br><span class="line">            pcm { }     <span class="comment"># Slave PCM definition</span></span><br><span class="line">            channels INT    <span class="comment"># Slave channels</span></span><br><span class="line">        }</span><br><span class="line">    bindings {      <span class="comment"># Bindings table</span></span><br><span class="line">        N {</span><br><span class="line">            slave STR   <span class="comment"># Slave key</span></span><br><span class="line">            channel INT <span class="comment"># Slave channel</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    [master INT]        <span class="comment"># Define the master slave</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>For example, to bind two PCM streams with two-channel stereo (hw:0,0 and hw:0,1) as one 4-channel stereo PCM stream, define like this:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pcm.quad {</span><br><span class="line">    <span class="built_in">type</span> multi</span><br><span class="line"> </span><br><span class="line">    slaves.a.pcm <span class="string">"hw:0,0"</span></span><br><span class="line">    slaves.a.channels 2</span><br><span class="line">    slaves.b.pcm <span class="string">"hw:0,1"</span></span><br><span class="line">    slaves.b.channels 2</span><br><span class="line"> </span><br><span class="line">    bindings.0.slave a</span><br><span class="line">    bindings.0.channel 0</span><br><span class="line">    bindings.1.slave a</span><br><span class="line">    bindings.1.channel 1</span><br><span class="line">    bindings.2.slave b</span><br><span class="line">    bindings.2.channel 0</span><br><span class="line">    bindings.3.slave b</span><br><span class="line">    bindings.3.channel 1</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Note that the resultant pcm “quad” is not in the interleaved format but in the “complex” format. Hence, it’s not accessible by applications which can handle only the interleaved (or the non-interleaved) format. In such a case, wrap this PCM with route or plug plugin.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pcm.quad2 {</span><br><span class="line">    <span class="built_in">type</span> route</span><br><span class="line">    slave.pcm <span class="string">"quad"</span></span><br><span class="line">    ttable.0.0 1</span><br><span class="line">    ttable.1.1 1</span><br><span class="line">    ttable.2.2 1</span><br><span class="line">    ttable.3.3 1</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="Plugin-dmix"><a href="#Plugin-dmix" class="headerlink" title="Plugin: dmix"></a>Plugin: dmix</h1><p>This plugin provides direct mixing of multiple streams. The resolution for 32-bit mixing is only 24-bit. The low significant byte is filled with zeros. The extra 8 bits are used for the saturation.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">    <span class="built_in">type</span> dmix       <span class="comment"># Direct mix</span></span><br><span class="line">    ipc_key INT     <span class="comment"># unique IPC key</span></span><br><span class="line">    ipc_key_add_uid BOOL    <span class="comment"># add current uid to unique IPC key</span></span><br><span class="line">    ipc_perm INT        <span class="comment"># IPC permissions (octal, default 0600)</span></span><br><span class="line">    hw_ptr_alignment STR    <span class="comment"># Slave application and hw pointer alignment type</span></span><br><span class="line">                <span class="comment"># STR can be one of the below strings :</span></span><br><span class="line">                <span class="comment"># no</span></span><br><span class="line">                <span class="comment"># roundup</span></span><br><span class="line">                <span class="comment"># rounddown</span></span><br><span class="line">                <span class="comment"># auto (default)</span></span><br><span class="line">    slave STR</span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    slave {         <span class="comment"># Slave definition</span></span><br><span class="line">        pcm STR     <span class="comment"># slave PCM name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        pcm { }     <span class="comment"># slave PCM definition</span></span><br><span class="line">        format STR  <span class="comment"># format definition</span></span><br><span class="line">        rate INT    <span class="comment"># rate definition</span></span><br><span class="line">        channels INT</span><br><span class="line">        period_time INT <span class="comment"># in usec</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        period_size INT <span class="comment"># in bytes</span></span><br><span class="line">        buffer_time INT <span class="comment"># in usec</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        buffer_size INT <span class="comment"># in bytes</span></span><br><span class="line">        periods INT <span class="comment"># when buffer_size or buffer_time is not specified</span></span><br><span class="line">    }</span><br><span class="line">    bindings {      <span class="comment"># note: this is client independent!!!</span></span><br><span class="line">        N INT       <span class="comment"># maps slave channel to client channel N</span></span><br><span class="line">    }</span><br><span class="line">    slowptr BOOL        <span class="comment"># slow but more precise pointer updates</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ipc_key 必须是整数形式的唯一 ipc key。对于每个不同的 dmix 定义，这个数字必须是唯一的，因为共享内存是用这个 key 创建的。当 ipc_key_add_uid 设置为 true 时，uid 值将添加到 ipc_key 设置中。这样可以避免同一个 IPC 密钥与不同用户同时发生冲突。</p>
<p>hw_ptr_alignment 这个配置默认是 auto</p>
<p>An example configuration for setting 44100 Hz, <code>S32_LE</code> format as the slave PCM of “hw:0” is like below:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pcm.dmix_44 {</span><br><span class="line">    <span class="built_in">type</span> dmix</span><br><span class="line">    ipc_key 321456  <span class="comment"># any unique value</span></span><br><span class="line">    ipc_key_add_uid <span class="literal">true</span></span><br><span class="line">    slave {</span><br><span class="line">        pcm <span class="string">"hw:0"</span></span><br><span class="line">        format S32_LE</span><br><span class="line">        rate 44100</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Test：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aplay -Dplug:dmix_44 foo_48k.wav</span><br></pre></td></tr></tbody></table></figure>
<h1 id="Plugin-dsnoop"><a href="#Plugin-dsnoop" class="headerlink" title="Plugin: dsnoop"></a>Plugin: dsnoop</h1><p>此插件将一个 capture 流拆分为多个。它的工作方式与 dmix 插件相反，从多个客户端同时读取共享捕获缓冲区。以下参数的含义与 dmix 插件几乎相同。</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">pcm.name {</span><br><span class="line">    <span class="built_in">type</span> dsnoop     <span class="comment"># Direct snoop</span></span><br><span class="line">    ipc_key INT     <span class="comment"># unique IPC key</span></span><br><span class="line">    ipc_key_add_uid BOOL    <span class="comment"># add current uid to unique IPC key</span></span><br><span class="line">    ipc_perm INT        <span class="comment"># IPC permissions (octal, default 0600)</span></span><br><span class="line">    slave STR</span><br><span class="line">    <span class="comment"># or</span></span><br><span class="line">    slave {         <span class="comment"># Slave definition</span></span><br><span class="line">        pcm STR     <span class="comment"># slave PCM name</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        pcm { }     <span class="comment"># slave PCM definition</span></span><br><span class="line">        format STR  <span class="comment"># format definition</span></span><br><span class="line">        rate INT    <span class="comment"># rate definition</span></span><br><span class="line">        channels INT</span><br><span class="line">        period_time INT <span class="comment"># in usec</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        period_size INT <span class="comment"># in bytes</span></span><br><span class="line">        buffer_time INT <span class="comment"># in usec</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        buffer_size INT <span class="comment"># in bytes</span></span><br><span class="line">        periods INT <span class="comment"># when buffer_size or buffer_time is not specified</span></span><br><span class="line">    }</span><br><span class="line">    bindings {      <span class="comment"># note: this is client independent!!!</span></span><br><span class="line">        N INT       <span class="comment"># maps slave channel to client channel N</span></span><br><span class="line">    }</span><br><span class="line">    slowptr BOOL        <span class="comment"># slow but more precise pointer updates</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="Open-流程"><a href="#Open-流程" class="headerlink" title="Open 流程"></a>Open 流程</h1><p>下面以 dsnoop 插件为例梳理下 alsa-lib 使用插件的流程，详细如下：</p>
<p><a target="_blank" rel="noopener" href="https://www.processon.com/view/link/65db097a5a48bc027688833d">原图</a><br><img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Audio/snd_pcm_dsnoop_open.png" alt=""></p>
<ul>
<li>解析配置文件并生成配置树</li>
<li>打开实际设备，通过 mmap 映射驱动中的控制信息和 buffer</li>
</ul>
<h1 id="Read-流程"><a href="#Read-流程" class="headerlink" title="Read 流程"></a>Read 流程</h1><p>以下是 read 流程，write 流程不再列出来了。</p>
<p><a target="_blank" rel="noopener" href="https://www.processon.com/view/link/65db09ac9a343d3e899d9182">原图</a><br><img src="https://lsky.carlyleliu.vip/carlyleliu/ImageHosting/TechnologyBlog/Audio/snd_pcm_readi.png" alt=""></p>
<ul>
<li>memcopy 驱动 DMA buffer 中的数据</li>
<li>hw_ptr 数据指针的 sync</li>
</ul>
<p>可以看到 alsa plug 支持多进程，可以多个进程打开同一个 slave 声卡，多进程间通过信号量同步。<br>如果要自己创建一个声卡，同时让创建的声卡支持 plugin，那么最好不要使用 appl_ptr 和依赖 appl_ptr 的 api。</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p><a target="_blank" rel="noopener" href="https://www.alsa-project.org/alsa-doc/alsa-lib/pcm_plugins.html">https://www.alsa-project.org/alsa-doc/alsa-lib/pcm_plugins.html</a><br><a target="_blank" rel="noopener" href="https://alsa.opensrc.org/ALSA_plugins">https://alsa.opensrc.org/ALSA_plugins</a></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Audio/">Audio</a><a class="post-meta__tags" href="/tags/ALSA/">ALSA</a><a class="post-meta__tags" href="/tags/Driver/">Driver</a></div><div class="post_share"><div class="social-share" data-image="https://unsplash.it/1600/900?random&amp;1597" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/LinuxKernel/LinuxKernelDebugVM/" title="Linux 内核调试（三）VM 参数调试"><img class="cover" src="https://unsplash.it/1600/900?random&amp;4143" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux 内核调试（三）VM 参数调试</div></div></a></div><div class="next-post pull-right"><a href="/LinuxDriver/LinuxAudioALSACreateSoundCard/" title="Linux 驱动之 ALSA（六）声卡创建流程"><img class="cover" src="https://unsplash.it/1600/900?random&amp;5500" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux 驱动之 ALSA（六）声卡创建流程</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/LinuxDriver/LinuxAudioALSACreateSoundCard/" title="Linux 驱动之 ALSA（六）声卡创建流程"><img class="cover" src="https://unsplash.it/1600/900?random&5500" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-17</div><div class="title">Linux 驱动之 ALSA（六）声卡创建流程</div></div></a></div><div><a href="/LinuxDriver/LinuxAudioALSAEncClass/" title="Linux 驱动之 ALSA（二）编解码器类驱动相关概念"><img class="cover" src="https://unsplash.it/1600/900?random&2926" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-16</div><div class="title">Linux 驱动之 ALSA（二）编解码器类驱动相关概念</div></div></a></div><div><a href="/LinuxDriver/LinuxAudioALSAMachineDriver/" title="Linux 驱动之 ALSA（五）Machine 驱动"><img class="cover" src="https://unsplash.it/1600/900?random&7220" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-06</div><div class="title">Linux 驱动之 ALSA（五）Machine 驱动</div></div></a></div><div><a href="/LinuxDriver/LinuxAudioALSAEncClassInstance/" title="Linux 驱动之 ALSA（三）编解码器类驱动实例"><img class="cover" src="https://unsplash.it/1600/900?random&1545" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-16</div><div class="title">Linux 驱动之 ALSA（三）编解码器类驱动实例</div></div></a></div><div><a href="/LinuxDriver/LinuxAudioALSAPlatformDriver/" title="Linux 驱动之 ALSA（四）Platform 驱动"><img class="cover" src="https://unsplash.it/1600/900?random&1931" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-26</div><div class="title">Linux 驱动之 ALSA（四）Platform 驱动</div></div></a></div><div><a href="/LinuxDriver/LinuxAudioALSASummer/" title="Linux 驱动之 ALSA（一）概述"><img class="cover" src="https://unsplash.it/1600/900?random&2469" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-06</div><div class="title">Linux 驱动之 ALSA（一）概述</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">CarlyleLiu</div><div class="author-info__description">CarlyleLiu’s Blog</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">194</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/carlyleliu"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/carlyleliu" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:yyliushuai@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-envelope" style="color: #24292e;"></i></a><a class="social-icon" href="https://twitter.com/yyliushuai" target="_blank" title="Twitter"><i class="fab fa-twitter" style="color: #24292e;"></i></a><a class="social-icon" href="https://youtube.com/carlyleliu" target="_blank" title="YouTube"><i class="fab fa-youtube" style="color: #24292e;"></i></a><a class="social-icon" href="https://instagram.com/blurredliu" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">next主题站 https://carlyleliu.github.io/next</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PCM-digital-audio-plugins"><span class="toc-number">1.</span> <span class="toc-text">PCM (digital audio) plugins</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Plugin-hw"><span class="toc-number">2.</span> <span class="toc-text">Plugin: hw</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Slave-definition"><span class="toc-number">3.</span> <span class="toc-text">Slave definition</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Plugin-Rate"><span class="toc-number">4.</span> <span class="toc-text">Plugin: Rate</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Plugin-Route-amp-Volume"><span class="toc-number">5.</span> <span class="toc-text">Plugin: Route &amp; Volume</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Automatic-conversion-plugin"><span class="toc-number">6.</span> <span class="toc-text">Automatic conversion plugin</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Plugin-Multiple-streams-to-One"><span class="toc-number">7.</span> <span class="toc-text">Plugin: Multiple streams to One</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Plugin-dmix"><span class="toc-number">8.</span> <span class="toc-text">Plugin: dmix</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Plugin-dsnoop"><span class="toc-number">9.</span> <span class="toc-text">Plugin: dsnoop</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Open-%E6%B5%81%E7%A8%8B"><span class="toc-number">10.</span> <span class="toc-text">Open 流程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Read-%E6%B5%81%E7%A8%8B"><span class="toc-number">11.</span> <span class="toc-text">Read 流程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-number">12.</span> <span class="toc-text">参考文献</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2025 By CarlyleLiu</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo" title=""><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly" title=""><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><!-- hexo injector body_end end --></body></html>