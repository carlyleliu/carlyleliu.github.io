<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Matrix - CarlyleLiu‘s Blog</title><meta name="author" content="CarlyleLiu"><meta name="copyright" content="CarlyleLiu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CarlyleLiu’s Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Matrix">
<meta property="og:url" content="https://carlyleliu.github.io/page/18/index.html">
<meta property="og:site_name" content="Matrix">
<meta property="og:description" content="CarlyleLiu’s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:author" content="CarlyleLiu">
<meta property="article:tag" content="Matrix">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://carlyleliu.github.io/page/18/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Matrix',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-10-26 11:44:13'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Matrix" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">194</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://unsplash.it/1600/900?random')"><nav id="nav"><span id="blog-info"><a href="/" title="Matrix"><span class="site-name">Matrix</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Matrix</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/carlyleliu" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:yyliushuai@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-envelope" style="color: #24292e;"></i></a><a class="social-icon" href="https://twitter.com/yyliushuai" target="_blank" title="Twitter"><i class="fab fa-twitter" style="color: #24292e;"></i></a><a class="social-icon" href="https://youtube.com/carlyleliu" target="_blank" title="YouTube"><i class="fab fa-youtube" style="color: #24292e;"></i></a><a class="social-icon" href="https://instagram.com/blurredliu" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #24292e;"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/LinuxDriver/LinuxDriverGPIO/" title="Linux 驱动之 GPIO 子系统"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;4238" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 驱动之 GPIO 子系统"></a></div><div class="recent-post-info"><a class="article-title" href="/LinuxDriver/LinuxDriverGPIO/" title="Linux 驱动之 GPIO 子系统">Linux 驱动之 GPIO 子系统</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-05T08:22:26.000Z" title="发表于 2020-09-05 16:22:26">2020-09-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/">Linux</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/Driver/">Driver</a></span></div><div class="content">GPIO 概述以前学习 stm32 的时候看到手册里有关于 gpio 的电路图，如下：

保护二极体：  IO 引脚上下两边两个二极体用于防止引脚外部过高、过低的电压输入。当引脚电压高于 VDD 时，上方的二极体导通；当引脚电压低于 VSS 时，下方的二极体导通，防止不正常电压引入晶片导致晶片烧毁

P-MOS 管和 N-MOS 管：  由 P-MOS 管和 N-MOS 管组成的单元电路使得 GPIO 具有“推挽输出”和“开漏输出”的模式

TTL 肖特基触发器：  信号经过触发器后，模拟信号转化为 0 和 1 的数字信号。但是，当 GPIO 引脚作为 ADC 采集电压的输入通道时，用其“模拟输入”功能，此时信号不再经过触发器进行 TTL 电平转换。ADC 外设要采集到的原始的模拟信号



STM32 的 GPIO 支持 4 种输入模式（浮空输入、上拉输入、下拉输入、模拟输入）和 4 种输出模式（开漏输出、开漏复用输出、推挽输出、推挽复用输出）

浮空输入模式：

上拉输入模式：

下拉输入模式：

模拟输入模式：

开漏输出模式：


开漏输出模式下，通过设定位设定/清除寄存器或者 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/LinuxDriver/LinuxDriverSPI/" title="Linux 驱动之 SPI 子系统"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;6767" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 驱动之 SPI 子系统"></a></div><div class="recent-post-info"><a class="article-title" href="/LinuxDriver/LinuxDriverSPI/" title="Linux 驱动之 SPI 子系统">Linux 驱动之 SPI 子系统</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-04T23:55:31.000Z" title="发表于 2020-09-05 07:55:31">2020-09-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/">Linux</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/Driver/">Driver</a></span></div><div class="content">Linux SPI 驱动框架对于 SPI 的驱动框架与 I2C 是大致一致的，也分为两层，控制器驱动程序层叫 spi_controller ，主要提供 transfer 函数，进行 spi 协议的收发。
另一层是设备驱动层，基于 spi_bus_type，在 driver 里则使用 spi_read、spi_writer 等函数，最终也会调用到 controller-&gt;transfer 函数进行发送接收。

数据结构整体数据结构如下：原图

spi_controller 结构体用于描述一个 spi 控制器，可以类比 iic 的 i2c_adapt。
spi_device 结构体用于描述一个 spi 设备，可以类比于 i2c_client 结构体。

spi_device 结构里有个 mode 很重要下面是其详细描述，SPI 模式主要有两个特征：    

CPOL：这是时钟极性：

0：初始时钟状态为低电平，第一个时钟边沿是上升沿    
1：初始时钟状态为高电平，第一个时钟边沿是下降沿    


CPHA：这是时钟相位，选择在哪个边沿采样数据：

0：数据在下降沿锁存，输出在 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/LinuxDriver/LinuxDriverPWM/" title="Linux 驱动之 PWM"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;5286" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 驱动之 PWM"></a></div><div class="recent-post-info"><a class="article-title" href="/LinuxDriver/LinuxDriverPWM/" title="Linux 驱动之 PWM">Linux 驱动之 PWM</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-02T08:45:17.000Z" title="发表于 2020-09-02 16:45:17">2020-09-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/">Linux</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/Driver/">Driver</a></span></div><div class="content">PWM 概述

Ton：信号高电平持续时间
Toff：信号底电平持续时间
Period： 完整 pwm 周期
Duty cycle：pwm 信号周期内保持为 ON 的时间百分比


Linux 下 PWM 驱动数据结构pwm 的数据结构如下图所示：原图

pwm_chip 结构体用于抽象 soc 的 pwm 控制器
pwm_device 用来抽象设备
pwm_state 表示 pwm 设备的周期、占空比、极性等信息
pwm ops 结构体提供一系列回调函数。这些回调函数的操作对象是具体的 pwm device

实现pwm 驱动分为 consumer 和 provider。其中 consumer 提供接口如下：
123static inline int pwm_config(struct pwm_device *pwm, int duty_ns, int period_ns) //配置 pwm device 的频率、占空比。static inline int pwm_enable(struct pwm_device *pwm)                            // ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/LinuxDriver/LinuxDriverIIC/" title="Linux 驱动之 IIC 子系统"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;4376" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 驱动之 IIC 子系统"></a></div><div class="recent-post-info"><a class="article-title" href="/LinuxDriver/LinuxDriverIIC/" title="Linux 驱动之 IIC 子系统">Linux 驱动之 IIC 子系统</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-08-29T08:27:44.000Z" title="发表于 2020-08-29 16:27:44">2020-08-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/">Linux</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/Driver/">Driver</a></span></div><div class="content">IIC 协议写操作流程如下：

主芯片要发出一个 start 信号
然后发出一个设备地址（用来确定是往哪一个芯片写数据），方向（读/写，0 表示写，1 表示读）
从设备回应（用来确定这个设备是否存在），然后就可以传输数据
主设备发送一个字节数据给从设备，并等待回应
每传输一字节数据，接收方要有一个回应信号（确定数据是否接受完成），然后再传输下一个数据
数据发送完之后，主芯片就会发送一个停止信号

下图：白色背景表示”主→从”，灰色背景表示”从→主”

读操作流程如下：

主芯片要发出一个 start 信号
然后发出一个设备地址（用来确定是往哪一个芯片写数据），方向（读/写，0 表示写，1 表示读）
从设备回应（用来确定这个设备是否存在），然后就可以传输数据
从设备发送一个字节数据给主设备，并等待回应
每传输一字节数据，接收方要有一个回应信号（确定数据是否接受完成），然后再传输下一个数据
数据发送完之后，主芯片就会发送一个停止信号

下图：白色背景表示”主→从”，灰色背景表示”从→主”
IIC 信号IIC 协议中数据传输的单位是字节，也就是 8 位。但是要用到 9 个时钟：前面 8 个时 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/LinuxDriver/LinuxDriverDeviceTree/" title="Linux 驱动之设备树"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;9232" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 驱动之设备树"></a></div><div class="recent-post-info"><a class="article-title" href="/LinuxDriver/LinuxDriverDeviceTree/" title="Linux 驱动之设备树">Linux 驱动之设备树</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-08-25T06:56:11.000Z" title="发表于 2020-08-25 14:56:11">2020-08-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/">Linux</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/Driver/">Driver</a></span></div><div class="content">dtb 数据解析内核启动阶段获得 dtb 位置指针以 arm64 为例，内核启动如下：
1234567891011__HEAD_head:#ifdef CONFIG_EFI	add	x13, x18, #0x16	b	stext#else	b	stext				// branch to kernel start, magic	.long	0				// reserved#endif...
在开启 UEFI 支持时，add x13, x18, #0x16 这个 code 实际上是为了满足 EFI 格式的”MZ”头。如果使用 UEFI 来启动 kernel, 会识别出来并走 UEFI 启动的流程，如果是普通的启动过程如使用 uboot 的 booti 进行引导，那么第一条指令就是一条 dummy 指令，第二条就跳转到 stext 运行了。

x0 寄存器保存的是 dtb 里 blob 块的物理地址，x0 寄存器内容由 uboot 设置，uboot 将 dtb 地址传递给内核，跳转到 stext，如下：
123456789101112131415161718192021222324ENTRY ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/LinuxDriver/LinuxDriverFileSystem/" title="Linux 驱动之文件系统"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;7897" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 驱动之文件系统"></a></div><div class="recent-post-info"><a class="article-title" href="/LinuxDriver/LinuxDriverFileSystem/" title="Linux 驱动之文件系统">Linux 驱动之文件系统</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-08-08T04:25:58.000Z" title="发表于 2020-08-08 12:25:58">2020-08-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/">Linux</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/Driver/">Driver</a></span></div><div class="content">seq_file概述seq_file 只是在普通文件 read 中加入了内核缓冲的功能，从而实现顺序多次遍历读取大数据量的简单接口，seq_file 一般只提供只读接口。
123456struct seq_operations {	void * (*start) (struct seq_file *m, loff_t *pos);	void (*stop) (struct seq_file *m, void *v);	void * (*next) (struct seq_file *m, void *v, loff_t *pos);	int (*show) (struct seq_file *m, void *v);};

核心功能seq_file 接口可通过  获得。 seq_file 包含三个方面：

An iterator interface which lets a virtual file implementation step through the objects it is presenting
Some utility functions for formatting ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/LinuxDriver/LinuxDriverDeviceModule/" title="Linux 驱动之设备驱动模型"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;7938" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 驱动之设备驱动模型"></a></div><div class="recent-post-info"><a class="article-title" href="/LinuxDriver/LinuxDriverDeviceModule/" title="Linux 驱动之设备驱动模型">Linux 驱动之设备驱动模型</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-08-07T06:52:33.000Z" title="发表于 2020-08-07 14:52:33">2020-08-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/">Linux</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Linux/Driver/">Driver</a></span></div><div class="content">kobject概述
Kobjects 有一个 name 和一个引用计数，还具有父指针（允许将对象排列成层次结构）
ktype 是嵌入在 kobject 结构体中的对象。 每个 kobject 结构都需要一个相应的 ktype。 ktype 控制 kobject 在创建和销毁时的行为
kset 是一组 kobjects(kset 本身包含一个 kobject), 这些 kobject 可以拥有相同的 ktype，kset 也是 sysfs 中的一个子目录。Ksets 可以支持 kobjects 的“热插拔”（uevent 事件）


kobject 的数据结构和实现下图展示了 kobject、ktype 和 kset 三者数据结构之间的关系：原图

sysfs_ops:  show 是回调函数，在读取具有该 kobj_type 的所有属性时调用他。缓冲区长度始终是 PAGE_SIZE，在成功时返回写入缓冲区的数据大小，失败返回错误码。写入的时候调用 store 函数，其参数 buf 最大为 PAGE_SIZE，成功返回写入数据大小，失败返回错误码

uevent_ops:  是此 kse ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/Algorithm/focRelatedAlgorithms/" title="foc 相关算法"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;1802" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="foc 相关算法"></a></div><div class="recent-post-info"><a class="article-title" href="/Algorithm/focRelatedAlgorithms/" title="foc 相关算法">foc 相关算法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-06-13T07:47:48.000Z" title="发表于 2020-06-13 15:47:48">2020-06-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Robot/">Robot</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Robot/Actuator/">Actuator</a></span></div><div class="content">MTPA为什么要用 MTPA当电机采用 id=0 的控制策略，这种控制方法忽略了磁阻转矩的作用，电磁转钜方程如下：

\tau _e = \frac{3}{2}p[k_e \cdot i_q + (L_d - L_q)\cdot i_d \cdot i_q]转矩分为永磁转矩 Tr 和磁阻转矩 Tm，而 id=0 只剩下 Tr。这会导致电流的利用率不高，系统的效率降低。所以 id=0 的控制比较适用于隐极式电机（Ld=Lq），而对于凸极式电机并不最优，所以需要重新考虑控制策略。

推导过程电动机电压方程：

\begin{aligned}
U_d = rI_d - L_qI_q\omega_e \\
U_q = rI_q + k_E\omega_e + L_dI_d\omega_e
\end{aligned}那么电动机消耗对有功功率为：

P = \frac{3}{2}(U_dI_d + U_qI_q)将电动机方程代入功率方程得：

P = \frac{3}{2} r (I_d^2 + I_q^2) + [k_EI_q + (L_d - L_q)I_dI_q]\omega_e电动机的有功 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/Algorithm/focPrinciple/" title="FOC 原理"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;7086" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FOC 原理"></a></div><div class="recent-post-info"><a class="article-title" href="/Algorithm/focPrinciple/" title="FOC 原理">FOC 原理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-06-11T06:34:39.000Z" title="发表于 2020-06-11 14:34:39">2020-06-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Robot/">Robot</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Robot/Actuator/">Actuator</a></span></div><div class="content">物理学基础概念左手定则将左手的食指，中指和拇指伸直，使其在空间内相互垂直。食指方向代表磁场的方向（从 N 级到 S 级），中指代表电流的方向（从正极到负极），那拇指所指的方向就是受力的方向。可用于判断安培力（运动导体所受到的力）和洛伦兹力（运动电荷所受的力）。
右手定则伸开右手，使拇指与其余四个手指垂直，并且都与手掌在同一平面内；让磁感线垂直于手心进入，并使拇指指向导线运动方向，这时四指所指的方向就是感应电流的方向。用于判断导体在做切割磁场时产生的电流方向。

安培定则（右手螺旋定则）电直导线中的安培定则（安培定则一）：用右手握住通电直导线，让大拇指指向直导线中电流方向，那么四指指向就是通电导线周围磁场的方向；通电螺线管中的安培定则（安培定则二）：用右手握住通电螺线管，让四指指向电流的方向，那么大拇指所指的那一端是通电螺线管的 N 极。
安培力定则安培力： 以电流强度为 I 的长度为 L 的直导线，置于磁感应强度为 B 的均匀外磁场中，则导线受到的安培力的大小为：

F = IBLsin\alpha式中α为导线中的电流方向与 B 方向之间的夹角。设定两条细直、无限长、固定的、相互平行的 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/Algorithm/openshoe/" title="openshoe 算法"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;3930" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="openshoe 算法"></a></div><div class="recent-post-info"><a class="article-title" href="/Algorithm/openshoe/" title="openshoe 算法">openshoe 算法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-06-05T20:07:42.000Z" title="发表于 2020-06-06 04:07:42">2020-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Robot/">Robot</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Robot/Actuator/">Actuator</a></span></div><div class="content">概述openshoe 是一种通过惯性测量元件 (IMU) 来对运动进行积分以得到路径的控制算法。算法的核心是 ZUPT（零速度更新算法），在只有 IMU 惯性测量元件的情况下获得路径只能通过对加速度积分得到速度，再将速度对时间进行积分得到路径，这里如果不能对积分得到的速度进行有效的校正那么这个速度误差会时刻对时间进行积分，导致路径完全失效，因此必须采取有效手段及时对速度误差进行校正以得到较为准确的路径信息，ZUPT 就是一种基于检测零速度进行路径积分校正的算法。该算法的关键是对零速度的准确检测。
零速度检测算法openshoe 采用广义似然检测算法对零速度进行检测，以判断 IMU 是否处于静止状态。
广义似然检测原理要理解广义似然检测原理需要先熟悉几个概率论中相关的概念，详细如下：

条件概率公式设 A 与 B 为样本空间 Ω 中的两个事件，其中 P(B)&gt;0。那么在事件 B 发生的条件下，事件 A 发生的条件概率为：

P(A|B) = \frac{P(AB)}{P(B)}贝叶斯公式
P(A|B) = \frac{P(B|A) P(A)}{P(B)}其中 A 以及 B 为随机事 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/17/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/#content-inner">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/#content-inner">19</a><a class="page-number" href="/page/20/#content-inner">20</a><a class="extend next" rel="next" href="/page/19/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">CarlyleLiu</div><div class="author-info__description">CarlyleLiu’s Blog</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">194</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/carlyleliu"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/carlyleliu" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:yyliushuai@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-envelope" style="color: #24292e;"></i></a><a class="social-icon" href="https://twitter.com/yyliushuai" target="_blank" title="Twitter"><i class="fab fa-twitter" style="color: #24292e;"></i></a><a class="social-icon" href="https://youtube.com/carlyleliu" target="_blank" title="YouTube"><i class="fab fa-youtube" style="color: #24292e;"></i></a><a class="social-icon" href="https://instagram.com/blurredliu" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">next主题站 https://carlyleliu.github.io/next</div></div><div class="sticky_layout"><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list expandBtn" id="aside-cat-list">
            <li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/Literature-Appreciation/"><span class="card-category-list-name">Literature Appreciation</span><span class="card-category-list-count">6</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Literature-Appreciation/Poetry/"><span class="card-category-list-name">Poetry</span><span class="card-category-list-count">6</span></a></li></ul></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/Science-Thought/"><span class="card-category-list-name">Science Thought</span><span class="card-category-list-count">8</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Science-Thought/Math/"><span class="card-category-list-name">Math</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Science-Thought/Physics/"><span class="card-category-list-name">Physics</span><span class="card-category-list-count">2</span></a></li></ul></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/Share/"><span class="card-category-list-name">Share</span><span class="card-category-list-count">4</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Share/Tools/"><span class="card-category-list-name">Tools</span><span class="card-category-list-count">4</span></a></li></ul></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/Technology-Blog/"><span class="card-category-list-name">Technology Blog</span><span class="card-category-list-count">176</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Audio/"><span class="card-category-list-name">Audio</span><span class="card-category-list-count">9</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Image/"><span class="card-category-list-name">Image</span><span class="card-category-list-count">51</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Image/Encryption/"><span class="card-category-list-name">Encryption</span><span class="card-category-list-count">25</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Image/ISP/"><span class="card-category-list-name">ISP</span><span class="card-category-list-count">11</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Image/Lens/"><span class="card-category-list-name">Lens</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Image/Sensor/"><span class="card-category-list-name">Sensor</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Image/Stabilization/"><span class="card-category-list-name">Stabilization</span><span class="card-category-list-count">9</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Linux/"><span class="card-category-list-name">Linux</span><span class="card-category-list-count">52</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Linux/Driver/"><span class="card-category-list-name">Driver</span><span class="card-category-list-count">16</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Linux/Kernel/"><span class="card-category-list-name">Kernel</span><span class="card-category-list-count">36</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Programming/"><span class="card-category-list-name">Programming</span><span class="card-category-list-count">33</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Programming/C-C/"><span class="card-category-list-name">C/C++</span><span class="card-category-list-count">11</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Programming/Debug/"><span class="card-category-list-name">Debug</span><span class="card-category-list-count">9</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Programming/Performance/"><span class="card-category-list-name">Performance</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Programming/Principle/"><span class="card-category-list-name">Principle</span><span class="card-category-list-count">9</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/RTOS/"><span class="card-category-list-name">RTOS</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Robot/"><span class="card-category-list-name">Robot</span><span class="card-category-list-count">7</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/Robot/Actuator/"><span class="card-category-list-name">Actuator</span><span class="card-category-list-count">7</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/TEE/"><span class="card-category-list-name">TEE</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/USB/"><span class="card-category-list-name">USB</span><span class="card-category-list-count">17</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Refactor/" style="font-size: 1.18em; color: #999ca1">Refactor</a> <a href="/tags/Driver/" style="font-size: 1.42em; color: #99a6b7">Driver</a> <a href="/tags/IMU/" style="font-size: 1.18em; color: #999ca1">IMU</a> <a href="/tags/Memory/" style="font-size: 1.3em; color: #99a1ac">Memory</a> <a href="/tags/Linux/" style="font-size: 1.5em; color: #99a9bf">Linux</a> <a href="/tags/Debug/" style="font-size: 1.34em; color: #99a3b0">Debug</a> <a href="/tags/Physics/" style="font-size: 1.14em; color: #999b9d">Physics</a> <a href="/tags/ucos/" style="font-size: 1.1em; color: #999">ucos</a> <a href="/tags/Poetry/" style="font-size: 1.26em; color: #999fa8">Poetry</a> <a href="/tags/Linear-Algebra/" style="font-size: 1.22em; color: #999ea4">Linear Algebra</a> <a href="/tags/Kernel/" style="font-size: 1.46em; color: #99a7bb">Kernel</a> <a href="/tags/USB/" style="font-size: 1.38em; color: #99a4b4">USB</a> <a href="/tags/Tools/" style="font-size: 1.22em; color: #999ea4">Tools</a> <a href="/tags/Performance/" style="font-size: 1.1em; color: #999">Performance</a> <a href="/tags/RTOS/" style="font-size: 1.14em; color: #999b9d">RTOS</a> <a href="/tags/Math/" style="font-size: 1.26em; color: #999fa8">Math</a> <a href="/tags/Odriver/" style="font-size: 1.18em; color: #999ca1">Odriver</a> <a href="/tags/FOC/" style="font-size: 1.18em; color: #999ca1">FOC</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">194</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2018-07-06T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-10-26T03:44:13.238Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2025 By CarlyleLiu</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js@2.1.0/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["潦倒不通世务，愚顽怕读文章","天下无能第一，古今不肖无双"])
  } else {
    document.getElementById("subtitle").textContent = "潦倒不通世务，愚顽怕读文章"
  }
}
typedJSFn.run(subtitleType)</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo" title=""><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly" title=""><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><!-- hexo injector body_end end --></body></html>